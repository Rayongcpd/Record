<!DOCTYPE html>
<html lang="th" class="h-full">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏∏‡∏°‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå</title>
    <meta name="description" content="‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö/‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏à‡∏±‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <style>
        body {
            box-sizing: border-box;
            font-family: 'Sarabun', sans-serif;
        }

        .gradient-header {
            background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 50%, #3d7ab5 100%);
        }

        .card-shadow {
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        .table-row:hover {
            background-color: #f0f7ff;
        }

        .status-pending {
            background: #fef3c7;
            color: #92400e;
        }

        .status-complete {
            background: #d1fae5;
            color: #065f46;
        }

        .status-processing {
            background: #dbeafe;
            color: #1e40af;
        }

        .modal-backdrop {
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }

        input[type="date"]::-webkit-calendar-picker-indicator {
            cursor: pointer;
        }

        .loading-overlay {
            background: rgba(255, 255, 255, 0.8);
        }
    </style>
</head>

<body class="h-full bg-gray-50">
    <div id="app" class="h-full w-full overflow-auto">
        <!-- Loading Overlay -->
        <div id="loading-overlay" class="fixed inset-0 z-[100] flex items-center justify-center loading-overlay hidden">
            <div class="text-center">
                <svg class="w-12 h-12 animate-spin text-blue-600 mx-auto" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor"
                        d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                    </path>
                </svg>
                <p class="mt-2 text-gray-600">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</p>
            </div>
        </div>

        <!-- Header -->
        <header class="gradient-header text-white py-6 px-4 shadow-lg">
            <div class="max-w-7xl mx-auto">
                <div class="flex items-center gap-3">
                    <svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z">
                        </path>
                    </svg>
                    <div>
                        <h1 class="text-2xl font-bold">‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏∏‡∏°‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå</h1>
                        <p class="text-blue-100 text-sm">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏à‡∏±‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå</p>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="max-w-7xl mx-auto px-4 py-6">
            <!-- Stats Cards -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                <div class="bg-white rounded-xl p-4 card-shadow border-l-4 border-blue-500">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 text-sm">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                            <p id="stat-total" class="text-2xl font-bold text-gray-800">0</p>
                        </div>
                        <div class="bg-blue-100 p-3 rounded-full">
                            <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z">
                                </path>
                            </svg>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-xl p-4 card-shadow border-l-4 border-yellow-500">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 text-sm">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</p>
                            <p id="stat-pending" class="text-2xl font-bold text-gray-800">0</p>
                        </div>
                        <div class="bg-yellow-100 p-3 rounded-full">
                            <svg class="w-6 h-6 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-xl p-4 card-shadow border-l-4 border-green-500">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 text-sm">‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß</p>
                            <p id="stat-complete" class="text-2xl font-bold text-gray-800">0</p>
                        </div>
                        <div class="bg-green-100 p-3 rounded-full">
                            <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-xl p-4 card-shadow border-l-4 border-purple-500">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 text-sm">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</p>
                            <p id="stat-processing" class="text-2xl font-bold text-gray-800">0</p>
                        </div>
                        <div class="bg-purple-100 p-3 rounded-full">
                            <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15">
                                </path>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Add New Button -->
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-semibold text-gray-800">‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏∏‡∏°‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö/‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö</h2>
                <button id="btn-add-new"
                    class="bg-blue-600 hover:bg-blue-700 text-white px-5 py-2.5 rounded-lg font-medium flex items-center gap-2 transition-colors">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                    </svg>
                    ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà
                </button>
            </div>

            <!-- Filter -->
            <div class="bg-white rounded-xl p-4 card-shadow mb-4">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-600 mb-1">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå</label>
                        <input type="text" id="filter-search" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå..."
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-600 mb-1">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</label>
                        <select id="filter-type"
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                            <option value="‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö">‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö</option>
                            <option value="‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö">‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-600 mb-1">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
                        <select id="filter-status"
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                            <option value="‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                            <option value="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                            <option value="‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß">‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß</option>
                        </select>
                    </div>
                    <div class="flex items-end">
                        <button id="btn-clear-filter"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á</button>
                    </div>
                </div>
            </div>

            <!-- Table -->
            <div class="bg-white rounded-xl card-shadow overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50 border-b border-gray-200">
                            <tr>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">‡∏™‡πà‡∏á‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£<br>(‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå)
                                </th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£
                                </th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏£‡πá‡∏à
                                </th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£<br>(‡∏Å‡∏•‡∏∏‡πà‡∏°)
                                </th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="table-body" class="divide-y divide-gray-100">
                            <tr>
                                <td colspan="12" class="px-4 py-12 text-center text-gray-500">
                                    <svg class="w-12 h-12 mx-auto mb-3 text-gray-300" fill="none" stroke="currentColor"
                                        viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z">
                                        </path>
                                    </svg>
                                    <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Pagination -->
            <div id="pagination-container"
                class="mt-4 bg-white rounded-xl p-4 card-shadow flex flex-col sm:flex-row items-center justify-between gap-4 hidden">
                <div class="flex items-center gap-2 text-sm text-gray-600">
                    <span>‡πÅ‡∏™‡∏î‡∏á:</span>
                    <select id="page-size"
                        class="px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <option value="10">10</option>
                        <option value="20">20</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                    </select>
                    <span>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤</span>
                </div>
                <div class="flex items-center gap-2">
                    <span id="pagination-info" class="text-sm text-gray-600 mr-2">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ 1-10 ‡∏à‡∏≤‡∏Å 100</span>
                    <button id="btn-first-page"
                        class="p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"
                        title="‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M11 19l-7-7 7-7m8 14l-7-7 7-7"></path>
                        </svg>
                    </button>
                    <button id="btn-prev-page"
                        class="p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"
                        title="‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7">
                            </path>
                        </svg>
                    </button>
                    <span class="px-3 py-1.5 bg-blue-50 text-blue-700 rounded-lg font-medium text-sm">
                        ‡∏´‡∏ô‡πâ‡∏≤ <span id="current-page">1</span> / <span id="total-pages">1</span>
                    </span>
                    <button id="btn-next-page"
                        class="p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"
                        title="‡∏ñ‡∏±‡∏î‡πÑ‡∏õ">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7">
                            </path>
                        </svg>
                    </button>
                    <button id="btn-last-page"
                        class="p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"
                        title="‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M13 5l7 7-7 7M5 5l7 7-7 7"></path>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Summary Section -->
            <div id="summary-section" class="mt-6 bg-white rounded-xl p-6 card-shadow hidden">
                <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2">
                    <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z">
                        </path>
                    </svg>
                    ‡∏™‡∏£‡∏∏‡∏õ‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏∏‡∏°
                </h3>
                <div id="summary-content" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
            </div>
        </main>

        <!-- Add/Edit Modal -->
        <div id="modal" class="fixed inset-0 z-50 hidden">
            <div class="modal-backdrop absolute inset-0" id="modal-backdrop"></div>
            <div class="relative flex items-center justify-center min-h-full p-4">
                <div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto relative">
                    <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 rounded-t-2xl">
                        <h2 id="modal-title" class="text-xl font-semibold text-gray-800">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà</h2>
                        <button id="btn-close-modal" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    <form id="form-record" class="p-6 space-y-4">
                        <input type="hidden" id="record-id">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="md:col-span-2">
                                <label class="block text-sm font-medium text-gray-700 mb-1">‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå <span
                                        class="text-red-500">*</span></label>
                                <input type="text" id="input-coop-name" list="coop-names-list" required
                                    class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                    placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå..." autocomplete="off">
                                <datalist id="coop-names-list"></datalist>
                            </div>
                            <div class="md:col-span-2">
                                <div class="flex items-center justify-between mb-2">
                                    <label class="block text-sm font-medium text-gray-700">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ <span
                                            class="text-red-500">*</span></label>
                                    <button type="button" id="btn-add-doc-item"
                                        class="text-sm text-blue-600 hover:text-blue-800 font-medium flex items-center gap-1">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M12 4v16m8-8H4"></path>
                                        </svg>
                                        ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
                                    </button>
                                </div>
                                <div id="doc-items-container" class="space-y-3">
                                    <!-- Dynamic rows will be here -->
                                </div>
                            </div>
                        </div>

                        <div class="border-t border-gray-200 pt-4">
                            <h4 class="font-medium text-gray-800 mb-3 flex items-center gap-2">
                                <span class="bg-blue-100 text-blue-700 px-2 py-1 rounded text-sm">1</span>
                                ‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö-‡∏™‡πà‡∏á‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå
                            </h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label
                                        class="block text-sm font-medium text-gray-700 mb-1">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏à‡∏≤‡∏Å‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå</label>
                                    <input type="date" id="input-receive-coop"
                                        class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div>
                                    <label
                                        class="block text-sm font-medium text-gray-700 mb-1">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå</label>
                                    <input type="date" id="input-send-coop"
                                        class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                </div>
                            </div>
                            <div id="coop-days-info" class="mt-2 text-sm text-blue-600 hidden"></div>
                        </div>

                        <div class="border-t border-gray-200 pt-4">
                            <h4 class="font-medium text-gray-800 mb-3 flex items-center gap-2">
                                <span class="bg-green-100 text-green-700 px-2 py-1 rounded text-sm">2</span>
                                ‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏à‡∏±‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏Ø
                            </h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label
                                        class="block text-sm font-medium text-gray-700 mb-1">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏Ø</label>
                                    <input type="date" id="input-receive-admin"
                                        class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div>
                                    <label
                                        class="block text-sm font-medium text-gray-700 mb-1">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏£‡πá‡∏à</label>
                                    <input type="date" id="input-group-complete"
                                        class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                </div>
                            </div>
                            <div id="group-days-info" class="mt-2 text-sm text-green-600 hidden"></div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
                            <select id="input-status"
                                class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                                <option value="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                                <option value="‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß">‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß</option>
                            </select>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
                            <textarea id="input-notes" rows="2"
                                class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..."></textarea>
                        </div>

                        <!-- File Attachment Section -->
                        <div class="border-t border-gray-200 pt-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                üìé ‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö
                            </label>
                            <div id="attachment-container">
                                <!-- Existing Attachment -->
                                <div id="current-attachment"
                                    class="hidden mb-3 p-3 bg-gray-50 rounded-lg flex items-center justify-between border border-gray-200">
                                    <div class="flex items-center gap-2 overflow-hidden">
                                        <svg class="w-5 h-5 text-blue-600 flex-shrink-0" fill="none"
                                            stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13">
                                            </path>
                                        </svg>
                                        <a id="attachment-link" href="#" target="_blank"
                                            class="text-blue-600 hover:underline truncate"></a>
                                    </div>
                                    <button type="button" id="btn-remove-attachment"
                                        class="text-red-500 hover:text-red-700 p-1 rounded hover:bg-red-50 transition-colors"
                                        title="‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16">
                                            </path>
                                        </svg>
                                    </button>
                                </div>

                                <!-- Drop zone -->
                                <div id="file-drop-zone"
                                    class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-500 hover:bg-blue-50 transition-all cursor-pointer">
                                    <div id="drop-zone-content">
                                        <svg class="w-10 h-10 mx-auto text-gray-400 mb-2" fill="none"
                                            stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12">
                                            </path>
                                        </svg>
                                        <p class="text-sm text-gray-600">‡∏•‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà ‡∏´‡∏£‡∏∑‡∏≠ <span
                                                class="text-blue-600 font-medium">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå</span></p>
                                        <p class="text-xs text-gray-400 mt-1">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö: PDF, JPG, PNG, DOC, DOCX
                                            (‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 10MB)</p>
                                    </div>
                                    <div id="selected-file-display" class="hidden">
                                        <p class="text-sm font-medium text-gray-800 break-all" id="selected-file-name">
                                        </p>
                                        <p class="text-xs text-gray-500 mt-1" id="selected-file-size"></p>
                                        <button type="button" id="btn-cancel-upload"
                                            class="mt-2 text-xs text-red-600 hover:text-red-800 underline">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                                    </div>
                                    <input type="file" id="file-input" class="hidden"
                                        accept=".pdf,.jpg,.jpeg,.png,.doc,.docx">
                                </div>

                                <!-- Progress bar -->
                                <div id="upload-progress" class="hidden mt-3">
                                    <div class="flex items-center justify-between mb-1">
                                        <span class="text-xs font-medium text-blue-700">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î...</span>
                                        <span id="progress-text" class="text-xs font-medium text-blue-700">0%</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                                        <div id="progress-bar"
                                            class="bg-blue-600 h-2.5 rounded-full transition-all duration-300"
                                            style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="flex gap-3 pt-4 border-t border-gray-200">
                            <button type="button" id="btn-cancel"
                                class="flex-1 px-4 py-2.5 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                            <button type="submit" id="btn-save"
                                class="flex-1 px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors font-medium flex items-center justify-center gap-2">
                                <span>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</span>
                                <svg id="save-spinner" class="w-5 h-5 animate-spin hidden" fill="none"
                                    viewBox="0 0 24 24">
                                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor"
                                        stroke-width="4"></circle>
                                    <path class="opacity-75" fill="currentColor"
                                        d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                                    </path>
                                </svg>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Delete Confirmation -->
        <div id="delete-modal" class="fixed inset-0 z-50 hidden">
            <div class="modal-backdrop absolute inset-0"></div>
            <div class="relative flex items-center justify-center min-h-full p-4">
                <div class="bg-white rounded-xl shadow-2xl w-full max-w-md p-6 relative">
                    <div class="text-center">
                        <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <svg class="w-8 h-8 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16">
                                </path>
                            </svg>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-2">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö</h3>
                        <p class="text-gray-600 mb-6">‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ</p>
                        <div class="flex gap-3">
                            <button id="btn-cancel-delete"
                                class="flex-1 px-4 py-2.5 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                            <button id="btn-confirm-delete"
                                class="flex-1 px-4 py-2.5 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors font-medium flex items-center justify-center gap-2">
                                <span>‡∏•‡∏ö</span>
                                <svg id="delete-spinner" class="w-5 h-5 animate-spin hidden" fill="none"
                                    viewBox="0 0 24 24">
                                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor"
                                        stroke-width="4"></circle>
                                    <path class="opacity-75" fill="currentColor"
                                        d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                                    </path>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Toast -->
        <div id="toast"
            class="fixed bottom-4 right-4 transform translate-y-20 opacity-0 transition-all duration-300 z-50">
            <div class="bg-gray-800 text-white px-6 py-3 rounded-lg shadow-lg flex items-center gap-3">
                <svg id="toast-icon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                <span id="toast-message">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</span>
            </div>
        </div>
    </div>

    <script>
        // ==================== CONFIG ====================
        // üî¥ ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô URL ‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô Web App URL ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å Deploy
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbygBTVqnvvc7cTwf8YIQCQpJ5xLKU7Z4TEuycKCcQP4UPfo6uXeONMUBwMxRRhD7C6xtQ/exec';

        // Thai Public Holidays 2024-2026 (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡πÉ‡∏ô Frontend)
        const PUBLIC_HOLIDAYS = [
            // 2024
            '2024-01-01', '2024-01-02', '2024-02-26', '2024-04-06', '2024-04-08',
            '2024-04-13', '2024-04-14', '2024-04-15', '2024-04-16', '2024-05-01',
            '2024-05-04', '2024-05-06', '2024-05-22', '2024-06-03', '2024-07-20',
            '2024-07-21', '2024-07-22', '2024-07-28', '2024-07-29', '2024-08-12',
            '2024-10-13', '2024-10-14', '2024-10-23', '2024-12-05', '2024-12-10',
            '2024-12-31',
            // 2025
            '2025-01-01', '2025-02-14', '2025-04-06', '2025-04-07', '2025-04-13',
            '2025-04-14', '2025-04-15', '2025-05-01', '2025-05-04', '2025-05-11',
            '2025-05-12', '2025-06-03', '2025-07-10', '2025-07-28', '2025-08-12',
            '2025-10-13', '2025-10-23', '2025-12-05', '2025-12-10', '2025-12-31',
            // 2026
            '2026-01-01', '2026-01-02', '2026-02-04', '2026-04-06', '2026-04-13',
            '2026-04-14', '2026-04-15', '2026-05-01', '2026-05-04', '2026-05-11',
            '2026-06-03', '2026-07-09', '2026-07-28', '2026-08-12', '2026-10-13',
            '2026-10-23', '2026-12-05', '2026-12-10', '2026-12-31'
        ];

        // ==================== STATE ====================
        let allRecords = [];
        let filteredRecords = [];
        let recordToDelete = null;
        let isEditing = false;
        let selectedFile = null;
        let currentAttachment = null;

        // Pagination state
        let currentPage = 1;
        let pageSize = 10;

        // ==================== COOPERATIVE NAMES ====================
        const COOP_NAMES = [
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡∏™‡∏ß‡∏ô‡∏¢‡∏≤‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡∏™‡∏´‡∏°‡∏¥‡∏ï‡∏£ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏®‡∏£‡∏µ‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏¢‡∏π‡πÄ‡∏ô‡∏µ‡πà‡∏¢‡∏ô ‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏°‡∏≤‡∏ö‡∏ï‡∏≤‡∏û‡∏∏‡∏î‡∏£‡πà‡∏ß‡∏°‡πÉ‡∏à ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÑ‡∏≠‡∏≠‡∏≤‡∏£‡πå‡∏û‡∏µ‡∏ã‡∏µ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏Ñ‡∏£‡∏π‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡∏†‡∏π‡∏ò‡∏£‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÇ‡∏Ñ‡πÄ‡∏ß‡∏™‡πÇ‡∏ï‡∏£‡∏°‡∏≤‡∏ö‡∏ï‡∏≤‡∏û‡∏∏‡∏î ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÑ‡∏≠‡∏≠‡∏≤‡∏£‡πå‡∏û‡∏µ‡∏ã‡∏µ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡∏™‡∏ß‡∏ô‡∏¢‡∏≤‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ö‡πâ‡∏≤‡∏ô‡∏ó‡πà‡∏≤‡πÄ‡∏™‡∏≤ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏ö‡πâ‡∏≤‡∏ô‡∏â‡∏≤‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏ú‡∏π‡πâ‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏î‡∏¥‡∏ô‡∏£‡∏ñ‡∏£‡∏∞‡∏¢‡∏≠‡∏á‡∏™‡∏≤‡∏°‡∏±‡∏Ñ‡∏Ñ‡∏µ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏£‡∏ñ‡∏£‡∏ß‡∏°‡πÉ‡∏à ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡∏ï‡∏≥‡∏ö‡∏•‡∏ö‡πâ‡∏≤‡∏ô‡∏â‡∏≤‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏¢‡∏≠‡∏á‡∏¢‡∏±‡πà‡∏á‡∏¢‡∏∑‡∏ô ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå ‡∏≠‡∏π‡πÄ‡∏ö‡∏∞ (‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢) ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏£‡πà‡∏ß‡∏°‡πÄ‡∏à‡∏£‡∏¥‡∏ç ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡πÑ‡∏≠‡∏≠‡∏≤‡∏£‡πå‡∏û‡∏µ‡∏ã‡∏µ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡∏™‡∏ß‡∏ô‡∏¢‡∏≤‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏ô‡∏¥‡∏ô‡∏™‡∏ß‡πà‡∏≤‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏¢‡∏π‡πÄ‡∏ô‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏Å‡∏≤‡∏∞‡∏Å‡∏Å‡∏´‡∏ô‡∏≠‡∏á‡πÅ‡∏ï‡∏á‡πÄ‡∏°‡∏£‡πà‡∏ß‡∏°‡πÉ‡∏à ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏£‡∏ñ‡∏ö‡πâ‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡∏¢‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏≠‡∏¥‡∏ô‡πÇ‡∏î‡∏£‡∏≤‡∏°‡∏≤ (2019) ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡πÑ‡∏ó‡∏¢‡πÇ‡∏û‡∏•‡∏µ‡∏≠‡∏∞‡∏ã‡∏µ‡∏ó‡∏±‡∏•‡πÅ‡∏•‡∏∞‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡πÑ‡∏ó‡∏¢‡πÇ‡∏û‡∏•‡∏µ‡∏Ñ‡∏≤‡∏£‡πå‡∏ö‡∏≠‡πÄ‡∏ô‡∏ï ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏≠‡∏¥‡∏ô‡πÇ‡∏î‡∏£‡∏≤‡∏°‡∏≤ ‡∏õ‡∏¥‡πÇ‡∏ï‡∏£‡πÄ‡∏Ñ‡∏° ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡πÄ‡∏≠‡πá‡∏ô‡∏û‡∏µ‡∏ã‡∏µ‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏£‡∏ñ‡∏ï‡∏≤‡∏Ç‡∏±‡∏ô ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Å‡∏≠‡∏á‡∏ö‡∏¥‡∏ô‡∏ó‡∏´‡∏≤‡∏£‡πÄ‡∏£‡∏∑‡∏≠ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏¢‡∏π‡πÄ‡∏ô‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡πÅ‡∏´‡∏•‡∏°‡∏£‡∏∏‡πà‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏á‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏¢‡∏π‡πÄ‡∏ô‡∏µ‡πà‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡πÑ‡∏£‡πà‡∏à‡∏±‡∏ô‡∏î‡∏µ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏î‡∏¥‡∏ô‡∏£‡∏ñ‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏£‡∏ñ‡∏õ‡∏≤‡∏Å‡∏ô‡πâ‡∏≥‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏£‡∏ñ‡∏£‡∏∞‡∏¢‡∏≠‡∏á‡∏£‡∏ß‡∏°‡∏£‡∏ñ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏õ‡∏£‡∏∞‡∏°‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏û ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏õ‡∏£‡∏∞‡∏°‡∏á‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡∏™‡∏ß‡∏ô‡∏¢‡∏≤‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡∏ä‡∏∏‡∏°‡∏ô‡∏∏‡∏°‡∏™‡∏π‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡πÄ‡∏Ç‡∏≤‡∏ä‡∏∞‡πÄ‡∏°‡∏≤ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÅ‡∏Å‡∏•‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏ö‡πâ‡∏≤‡∏ô‡∏ô‡πâ‡∏≥‡πÄ‡∏õ‡πá‡∏ô ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡∏™‡∏ß‡∏ô‡∏¢‡∏≤‡∏á‡∏ï‡∏≥‡∏ö‡∏•‡∏ä‡∏≥‡∏Ü‡πâ‡∏≠ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏ó‡∏∏‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏¢‡∏Å‡∏¥‡∏ô ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏ö‡πâ‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡∏¢ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏¢‡∏π‡πÄ‡∏ô‡∏µ‡πà‡∏¢‡∏ô‡∏≠‡∏≤‡πÇ‡∏≠‡∏¢‡∏≤‡∏°‡πà‡∏≤‡πÑ‡∏ó‡∏¢ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏¢‡∏π‡πÄ‡∏ô‡∏µ‡πà‡∏¢‡∏ô ‡πÄ‡∏≠‡πÄ‡∏≠‡∏ó‡∏µ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏¢‡∏π‡πÄ‡∏ô‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏•‡∏∞‡∏´‡∏≤‡∏£ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏¢‡∏π‡πÄ‡∏ô‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏≠‡∏ü ‡∏ó‡∏µ ‡πÄ‡∏≠‡πá‡∏° ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏î‡∏≠‡∏Å‡∏Å‡∏£‡∏≤‡∏¢ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏ó‡∏™‡∏∏‡∏°‡∏¥‡πÄ‡∏ó‡πá‡∏Ñ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏≠‡πÄ‡∏î‡∏µ‡∏¢‡∏ô‡∏ó‡πå ‡πÅ‡∏≠‡∏ô‡∏î‡πå ‡∏ã‡∏±‡∏°‡∏°‡∏¥‡∏ó ‡∏Ñ‡∏≠‡∏£‡πå‡∏õ‡∏≠‡πÄ‡∏£‡∏ä‡∏±‡πà‡∏ô ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏ä‡∏∏‡∏°‡∏ô‡∏∏‡∏°‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏õ‡∏•‡∏ß‡∏Å‡πÅ‡∏î‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏°‡∏ñ‡∏∏‡∏á‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å‡πÑ‡∏ó‡∏¢ ‡πÅ‡∏•‡∏∞‡πÄ‡∏≠‡πÄ‡∏õ‡∏Ñ‡∏ü‡∏¥‡∏•‡πå‡∏° ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏°‡∏¥‡∏ï‡∏ã‡∏∏‡∏¢ ‡πÑ‡∏Æ‡∏¢‡∏µ‡∏ô ‡πÅ‡∏°‡∏ó‡∏ó‡∏µ‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡∏™‡πå (‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢) ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ú‡∏±‡∏á 2 ‡∏î‡∏≠‡∏Å‡∏Å‡∏£‡∏≤‡∏¢ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏î‡∏¥‡∏ô‡∏£‡∏ñ‡∏û‡∏ô‡∏≤‡∏ô‡∏¥‡∏Ñ‡∏° ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏´‡∏™‡∏ñ‡∏≤‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏Å‡πâ‡∏≤‡∏ß‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏ô‡∏¥‡∏Ñ‡∏°‡∏Ø ‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏°‡∏¥‡∏ï‡∏ã‡∏π‡∏ö‡∏¥‡∏ä‡∏¥ ‡∏≠‡∏¥‡πÄ‡∏•‡∏Ñ‡∏ó‡∏£‡∏¥‡∏Ñ‡πÑ‡∏ó‡∏¢ ‡∏≠‡∏≠‡πÇ‡∏ï‡πâ-‡∏û‡∏≤‡∏£‡πå‡∏ó ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏´‡∏†‡∏≤‡∏û‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏°‡∏ó‡πà‡∏≠‡πÄ‡∏´‡∏•‡πá‡∏Å ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡πÇ‡∏ï‡πÑ‡∏Å ‡∏≠‡∏µ‡∏™‡πÄ‡∏ó‡∏¥‡∏£‡πå‡∏ô ‡∏£‡∏±‡∏ö‡πÄ‡∏ö‡∏≠‡∏£‡πå (‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢) ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏ã‡∏ô‡∏ï‡πå‡πÇ‡∏Å‡πÄ‡∏ö‡∏ô ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏°‡∏¥‡∏Å‡∏≤‡∏ã‡πà‡∏≤ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏¢‡∏π‡πÄ‡∏ô‡∏µ‡πà‡∏¢‡∏ô‡∏¢‡∏≤‡∏ô‡∏≤‡∏Å‡∏≤‡∏ß‡πà‡∏≤ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏¢‡∏π‡πÄ‡∏ô‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏¢‡∏≤‡∏°‡πÇ‡∏Å‡∏ä‡∏¥ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡∏™‡∏ß‡∏ô‡∏¢‡∏≤‡∏á‡∏õ‡∏•‡∏ß‡∏Å‡πÅ‡∏î‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡πÑ‡∏î‡∏Å‡∏¥‡πâ‡∏ô‡∏Ñ‡∏≠‡∏°‡πÄ‡∏û‡∏£‡∏™‡πÄ‡∏ã‡∏≠‡∏£‡πå ‡∏≠‡∏¥‡∏ô‡∏î‡∏±‡∏™‡∏ó‡∏£‡∏µ‡πâ‡∏™‡πå ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏ä‡∏π‡πÇ‡∏≠‡πÑ‡∏ó‡∏¢ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡πÑ‡∏ó‡∏¢‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå‡∏°‡∏¥‡∏•‡∏•‡πå ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Ñ‡∏≤‡∏ß‡∏≤‡∏ã‡∏≤‡∏Å‡∏¥ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏ã‡∏±‡∏á‡πÇ‡∏Å‡∏∞‡πÑ‡∏ó‡∏¢ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏¢‡∏π‡πÄ‡∏ô‡∏µ‡πà‡∏¢‡∏ô‡∏¢‡∏≤‡∏°‡∏≤‡∏î‡∏∞‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏¢‡∏π‡πÄ‡∏ô‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏´‡∏†‡∏≤‡∏û‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏ã‡∏π‡∏°‡∏¥‡πÇ‡∏ï‡πÇ‡∏°‡πà ‡∏£‡∏±‡∏ö‡πÄ‡∏ö‡∏≠‡∏£‡πå ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏´‡∏™‡∏ñ‡∏≤‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡∏™‡∏≤‡∏¢ 11 ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ô‡∏¥‡∏Ñ‡∏°‡∏ä‡∏∏‡∏°‡πÅ‡∏™‡∏á‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ô‡∏¥‡∏Ñ‡∏°‡∏ß‡∏±‡∏á‡πÑ‡∏ó‡∏£ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ô‡∏¥‡∏Ñ‡∏°‡πÄ‡∏Ç‡∏≤‡∏û‡∏ô‡∏°‡∏™‡∏≤‡∏£‡πå‡∏ó ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ô‡∏¥‡∏Ñ‡∏°‡∏õ‡πà‡∏≤‡∏¢‡∏∏‡∏ö‡πÉ‡∏ô ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ ‡∏ò.‡∏Å.‡∏™.‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏™‡∏ß‡∏ô‡∏¢‡∏≤‡∏á‡∏û‡∏≤‡∏£‡∏≤‡∏ö‡∏≤‡∏á‡∏ö‡∏∏‡∏ï‡∏£',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏ô‡∏≤‡πÄ‡∏ä‡∏¥‡∏á‡πÄ‡∏ô‡∏¥‡∏ô',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏™‡∏ß‡∏ô‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏ó‡πâ‡∏≠‡∏ô',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏õ‡∏£‡∏∞‡∏°‡∏á‡∏õ‡∏≤‡∏Å‡∏ô‡πâ‡∏≥‡∏£‡∏∞‡∏¢‡∏≠‡∏á',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡πÑ‡∏£‡πà‡∏™‡∏±‡∏ö‡∏õ‡∏∞‡∏£‡∏î‡∏ï‡∏≥‡∏ö‡∏•‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏ó‡πâ‡∏≠‡∏ô',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏™‡∏ß‡∏ô‡∏ä‡∏≤‡∏Å‡∏ö‡∏Å',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏ô‡∏≤‡∏ó‡∏≤‡∏á‡πÄ‡∏Å‡∏ß‡∏µ‡∏¢‡∏ô',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏™‡∏ß‡∏ô‡πÄ‡∏Ç‡∏≤‡∏ô‡πâ‡∏≠‡∏¢',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏™‡∏ß‡∏ô‡∏ä‡∏∏‡∏°‡πÅ‡∏™‡∏á',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏™‡∏ß‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏ô‡∏≤',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏™‡∏ß‡∏ô‡∏ß‡∏±‡∏á‡∏´‡∏ß‡πâ‡∏≤',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏õ‡∏•‡∏π‡∏Å‡∏™‡∏±‡∏ö‡∏õ‡∏∞‡∏£‡∏î‡∏ó‡∏≤‡∏á‡πÄ‡∏Å‡∏ß‡∏µ‡∏¢‡∏ô',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡πÑ‡∏£‡πà‡∏™‡∏±‡∏ö‡∏õ‡∏∞‡∏£‡∏î‡∏ï‡∏≥‡∏ö‡∏•‡∏ä‡∏≥‡∏Ü‡πâ‡∏≠',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏™‡∏ß‡∏ô‡∏ô‡πâ‡∏≥‡πÄ‡∏õ‡πá‡∏ô',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏™‡∏ß‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏ä‡∏≤‡∏Å‡∏û‡∏á‡∏£‡∏ß‡∏°‡∏õ‡∏±‡∏ç‡∏ç‡∏≤',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏™‡∏ß‡∏ô‡∏õ‡πà‡∏≤‡∏¢‡∏∏‡∏ö‡πÉ‡∏ô',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏™‡∏ß‡∏ô‡∏ó‡∏∏‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏¢‡∏Å‡∏¥‡∏ô',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏™‡∏ß‡∏ô‡∏´‡πâ‡∏ß‡∏¢‡∏ó‡∏±‡∏ö‡∏°‡∏≠‡∏ç',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡πÑ‡∏£‡πà‡∏•‡∏∞‡∏´‡∏≤‡∏£',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡πÑ‡∏£‡πà‡∏™‡∏±‡∏ö‡∏õ‡∏∞‡∏£‡∏î‡∏û‡∏ô‡∏≤‡∏ô‡∏¥‡∏Ñ‡∏°',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡πÑ‡∏£‡πà‡∏™‡∏±‡∏ö‡∏õ‡∏∞‡∏£‡∏î‡∏ï‡∏≥‡∏ö‡∏•‡∏õ‡∏•‡∏ß‡∏Å‡πÅ‡∏î‡∏á',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏ô‡∏≤‡∏ö‡πâ‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡∏¢',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏ô‡∏≤‡∏ö‡∏≤‡∏á‡∏ö‡∏∏‡∏ï‡∏£',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡πÑ‡∏£‡πà‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≥‡∏Ñ‡∏π‡πâ',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡πÑ‡∏£‡πà‡∏™‡∏±‡∏ö‡∏õ‡∏∞‡∏£‡∏î‡∏°‡∏∞‡∏Ç‡∏≤‡∏°‡∏Ñ‡∏π‡πà',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡πÑ‡∏£‡πà‡∏ô‡∏¥‡∏Ñ‡∏°‡∏û‡∏±‡∏í‡∏ô‡∏≤',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡πÑ‡∏£‡πà‡∏°‡∏≤‡∏ö‡∏¢‡∏≤‡∏á‡∏û‡∏£',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡πÑ‡∏£‡πà‡∏°‡∏≤‡∏ö‡∏Ç‡πà‡∏≤',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏Ñ‡∏ô‡∏û‡∏¥‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÅ‡∏û‡∏∞‡∏ï‡∏≥‡∏ö‡∏•‡∏û‡∏±‡∏á‡∏£‡∏≤‡∏î',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ú‡∏π‡πâ‡∏õ‡∏•‡∏π‡∏Å‡∏™‡∏±‡∏ö‡∏õ‡∏∞‡∏£‡∏î‡∏ï‡∏≥‡∏ö‡∏•‡∏´‡∏ô‡∏≠‡∏á‡πÑ‡∏£‡πà',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏™‡∏ß‡∏ô‡∏ï‡∏≥‡∏ö‡∏•‡∏ï‡∏≤‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå'
        ];

        // Initialize datalist on page load
        function initCoopNamesList() {
            const datalist = document.getElementById('coop-names-list');
            datalist.innerHTML = COOP_NAMES.map(name => `<option value="${name}">`).join('');
        }

        // ==================== UTILITY FUNCTIONS ====================

        /**
         * Calculate working days between two dates
         * Excludes weekends (Sat/Sun) and Thai public holidays
         */
        function calculateWorkingDays(startDate, endDate) {
            if (!startDate || !endDate) return null;

            const start = new Date(startDate);
            const end = new Date(endDate);

            if (start > end) return null;

            let workingDays = 0;
            const current = new Date(start);

            // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ (‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö)
            current.setDate(current.getDate() + 1);

            while (current <= end) {
                const dayOfWeek = current.getDay();
                const dateStr = current.toISOString().split('T')[0];

                // Skip weekends (0 = Sunday, 6 = Saturday) and public holidays
                if (dayOfWeek !== 0 && dayOfWeek !== 6 && !PUBLIC_HOLIDAYS.includes(dateStr)) {
                    workingDays++;
                }

                current.setDate(current.getDate() + 1);
            }

            return workingDays;
        }

        /**
         * Format date string to Thai format
         */
        function formatDate(dateStr) {
            if (!dateStr) return '-';
            const date = new Date(dateStr);
            return date.toLocaleDateString('th-TH', { day: '2-digit', month: '2-digit', year: 'numeric' });
        }

        /**
         * Show/hide loading overlay
         */
        function showLoading(show = true) {
            const overlay = document.getElementById('loading-overlay');
            if (show) {
                overlay.classList.remove('hidden');
            } else {
                overlay.classList.add('hidden');
            }
        }

        /**
         * Show toast notification
         */
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toast-message');
            const toastIcon = document.getElementById('toast-icon');

            toastMessage.textContent = message;

            if (type === 'error') {
                toastIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>';
                toast.querySelector('div').classList.remove('bg-gray-800');
                toast.querySelector('div').classList.add('bg-red-600');
            } else {
                toastIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>';
                toast.querySelector('div').classList.remove('bg-red-600');
                toast.querySelector('div').classList.add('bg-gray-800');
            }

            toast.classList.remove('translate-y-20', 'opacity-0');

            setTimeout(() => {
                toast.classList.add('translate-y-20', 'opacity-0');
            }, 3000);
        }

        // ==================== API FUNCTIONS ====================

        /**
         * Fetch all records from backend
         */
        async function fetchAllRecords() {
            try {
                showLoading(true);
                const response = await fetch(`${SCRIPT_URL}?action=getAll`, {
                    redirect: 'follow'
                });
                const result = await response.json();

                if (result.success) {
                    allRecords = result.data;
                    applyFiltersAndRender();
                    updateStats();
                    updateSummary();
                } else {
                    showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ' + result.error, 'error');
                }
            } catch (error) {
                console.error('Error fetching records:', error);
                showToast('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏î‡πâ', 'error');
                renderEmptyState();
            } finally {
                showLoading(false);
            }
        }

        /**
         * Create new record
         */
        async function createRecord(recordData) {
            const response = await fetch(SCRIPT_URL, {
                method: 'POST',
                redirect: 'follow',
                body: JSON.stringify({ action: 'create', record: recordData })
            });
            return await response.json();
        }

        /**
         * Create multiple records
         */
        async function createRecordBatch(records) {
            const response = await fetch(SCRIPT_URL, {
                method: 'POST',
                redirect: 'follow',
                body: JSON.stringify({ action: 'createBatch', records: records })
            });
            return await response.json();
        }

        /**
         * Update existing record
         */
        async function updateRecord(recordData) {
            const response = await fetch(SCRIPT_URL, {
                method: 'POST',
                redirect: 'follow',
                body: JSON.stringify({ action: 'update', record: recordData })
            });
            return await response.json();
        }

        /**
         * Delete record
         */
        async function deleteRecordApi(id) {
            const response = await fetch(SCRIPT_URL, {
                method: 'POST',
                redirect: 'follow',
                body: JSON.stringify({ action: 'delete', id: id })
            });
            return await response.json();
        }

        /**
         * Upload file
         */
        async function uploadFileApi(fileData, fileName, mimeType, cooperativeName) {
            const response = await fetch(SCRIPT_URL, {
                method: 'POST',
                redirect: 'follow',
                body: JSON.stringify({
                    action: 'uploadFile',
                    fileData,
                    fileName,
                    mimeType,
                    cooperativeName
                })
            });
            return await response.json();
        }

        /**
         * Delete file
         */
        async function deleteFileApi(fileId) {
            const response = await fetch(SCRIPT_URL, {
                method: 'POST',
                redirect: 'follow',
                body: JSON.stringify({ action: 'deleteFile', fileId })
            });
            return await response.json();
        }

        // ==================== UI FUNCTIONS ====================

        function createDocItemRow(type = '', topic = '') {
            const div = document.createElement('div');
            div.className = 'doc-item-row grid grid-cols-1 md:grid-cols-2 gap-4 p-3 bg-gray-50 rounded-lg border border-gray-200 relative';
            div.innerHTML = `
                <div>
                     <label class="block text-xs font-medium text-gray-500 mb-1">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</label>
                     <select class="doc-type w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</option>
                        <option value="‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö" ${type === '‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö' ? 'selected' : ''}>‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö</option>
                        <option value="‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö" ${type === '‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö' ? 'selected' : ''}>‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö</option>
                     </select>
                </div>
                <div>
                     <label class="block text-xs font-medium text-gray-500 mb-1">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠</label>
                     <input type="text" class="doc-topic w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠" value="${topic}" required>
                </div>
                <button type="button" class="btn-remove-doc-item absolute -top-2 -right-2 bg-red-100 text-red-500 rounded-full p-1 shadow-sm hover:bg-red-200 transition-colors">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            `;

            // Remove button event
            div.querySelector('.btn-remove-doc-item').addEventListener('click', () => {
                const container = document.getElementById('doc-items-container');
                if (container.children.length > 1) {
                    div.remove();
                } else {
                    showToast('‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£', 'error');
                }
            });

            return div;
        }

        function showModal() {
            document.getElementById('modal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function hideModal() {
            document.getElementById('modal').classList.add('hidden');
            document.body.style.overflow = '';
        }

        function showDeleteModal(record) {
            recordToDelete = record;
            document.getElementById('delete-modal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function hideDeleteModal() {
            recordToDelete = null;
            document.getElementById('delete-modal').classList.add('hidden');
            document.body.style.overflow = '';
        }

        function updateCoopDaysInfo() {
            const startDate = document.getElementById('input-receive-coop').value;
            const endDate = document.getElementById('input-send-coop').value;
            const infoDiv = document.getElementById('coop-days-info');

            if (startDate && endDate) {
                const days = calculateWorkingDays(startDate, endDate);
                if (days !== null) {
                    infoDiv.textContent = `üìÖ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£: ${days} ‡∏ß‡∏±‡∏ô (‡πÑ‡∏°‡πà‡∏ô‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡πÄ‡∏™‡∏≤‡∏£‡πå-‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå)`;
                    infoDiv.classList.remove('hidden');
                } else {
                    infoDiv.classList.add('hidden');
                }
            } else {
                infoDiv.classList.add('hidden');
            }
        }

        function updateGroupDaysInfo() {
            const startDate = document.getElementById('input-receive-admin').value;
            const endDate = document.getElementById('input-group-complete').value;
            const infoDiv = document.getElementById('group-days-info');

            if (startDate && endDate) {
                const days = calculateWorkingDays(startDate, endDate);
                if (days !== null) {
                    infoDiv.textContent = `üìÖ ‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£: ${days} ‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£`;
                    infoDiv.classList.remove('hidden');
                } else {
                    infoDiv.classList.add('hidden');
                }
            } else {
                infoDiv.classList.add('hidden');
            }
        }

        async function handleFormSubmit(e) {
            e.preventDefault();

            const saveBtn = document.getElementById('btn-save');
            const spinner = document.getElementById('save-spinner');
            saveBtn.disabled = true;
            spinner.classList.remove('hidden');

            const coopName = document.getElementById('input-coop-name').value.trim();

            try {
                // Initialize common record data
                const baseRecordData = {
                    cooperative_name: coopName,
                    receive_from_coop_date: document.getElementById('input-receive-coop').value || '',
                    send_back_to_coop_date: document.getElementById('input-send-coop').value || '',
                    receive_from_admin_date: document.getElementById('input-receive-admin').value || '',
                    group_complete_date: document.getElementById('input-group-complete').value || '',
                    status: document.getElementById('input-status').value,
                    notes: document.getElementById('input-notes').value.trim()
                };

                // Gather Document Items
                const docItems = document.querySelectorAll('.doc-item-row');
                const recordsToSave = [];

                docItems.forEach(row => {
                    recordsToSave.push({
                        ...baseRecordData,
                        document_type: row.querySelector('.doc-type').value,
                        document_topic: row.querySelector('.doc-topic').value.trim()
                    });
                });

                // Handle file upload if exists
                if (selectedFile) {
                    showLoading(true); // Ensure loading is shown

                    // Convert file to Base64
                    const fileReader = new FileReader();
                    const base64Promise = new Promise((resolve, reject) => {
                        fileReader.onload = () => resolve(fileReader.result.split(',')[1]);
                        fileReader.onerror = reject;
                        fileReader.readAsDataURL(selectedFile);
                    });

                    const base64Data = await base64Promise;

                    // Show progress UI (simulated)
                    document.getElementById('upload-progress').classList.remove('hidden');
                    document.getElementById('progress-bar').style.width = '100%';
                    document.getElementById('progress-text').textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î...';

                    // Upload to Drive
                    const uploadResult = await uploadFileApi(base64Data, selectedFile.name, selectedFile.type, coopName);

                    if (uploadResult.success) {
                        // Add attachment info to base record data
                        baseRecordData.attachment_file_id = uploadResult.data.fileId;
                        baseRecordData.attachment_file_name = uploadResult.data.fileName;
                        baseRecordData.attachment_file_url = uploadResult.data.fileUrl;

                        // If we had a previous file and we are editing, we might want to delete it?
                        // For now, let's just replace the reference.
                        // Future improvement: delete old file if replaced.
                    } else {
                        throw new Error('Upload failed: ' + uploadResult.error);
                    }
                } else if (currentAttachment) {
                    // Keep existing attachment info
                    recordData.attachment_file_id = currentAttachment.id;
                    recordData.attachment_file_name = currentAttachment.name;
                    recordData.attachment_file_url = currentAttachment.url;
                }

                const recordId = document.getElementById('record-id').value;
                let result;

                // Handle Attachment for ALL records
                // If creating multiple records, they all get the same attachment reference
                recordsToSave.forEach(record => {
                    if (selectedFile) {
                        record.attachment_file_id = baseRecordData.attachment_file_id;
                        record.attachment_file_name = baseRecordData.attachment_file_name;
                        record.attachment_file_url = baseRecordData.attachment_file_url;
                    } else if (currentAttachment) {
                        record.attachment_file_id = currentAttachment.id;
                        record.attachment_file_name = currentAttachment.name;
                        record.attachment_file_url = currentAttachment.url;
                    }
                });

                if (isEditing && recordId) {
                    // Edit Mode: Update single record (take the first item, as edit mode forces 1 item)
                    const recordData = recordsToSave[0];
                    recordData.id = recordId;
                    result = await updateRecord(recordData);
                } else {
                    // Create Mode: Batch or Single
                    if (recordsToSave.length > 1) {
                        result = await createRecordBatch(recordsToSave);
                    } else {
                        result = await createRecord(recordsToSave[0]);
                    }
                }

                if (result && result.success) {
                    showToast(isEditing ? '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à' : '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
                    hideModal();
                    await fetchAllRecords();
                } else {
                    showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + (result.error || '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà'), 'error');
                }
            } catch (err) {
                console.error('Error saving record:', err);
                showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + err.message, 'error');
            } finally {
                saveBtn.disabled = false;
                spinner.classList.add('hidden');
                document.getElementById('upload-progress').classList.add('hidden');
                showLoading(false);
            }
        }

        function editRecord(record) {
            isEditing = true;
            document.getElementById('modal-title').textContent = '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£';
            document.getElementById('record-id').value = record.id;
            document.getElementById('input-coop-name').value = record.cooperative_name || '';

            // Setup Doc Items for Edit
            const container = document.getElementById('doc-items-container');
            container.innerHTML = '';
            container.appendChild(createDocItemRow(record.document_type || '', record.document_topic || ''));

            // Hide Add/Remove buttons in Edit Mode
            document.getElementById('btn-add-doc-item').classList.add('hidden');
            container.querySelectorAll('.btn-remove-doc-item').forEach(btn => btn.classList.add('hidden'));

            document.getElementById('input-receive-coop').value = record.receive_from_coop_date || '';
            document.getElementById('input-send-coop').value = record.send_back_to_coop_date || '';
            document.getElementById('input-receive-admin').value = record.receive_from_admin_date || '';
            document.getElementById('input-group-complete').value = record.group_complete_date || '';
            document.getElementById('input-status').value = record.status || '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£';
            updateCoopDaysInfo();
            updateGroupDaysInfo();

            // Handle Attachment
            selectedFile = null;
            resetFileUploadUI();

            if (record.attachment_file_id) {
                currentAttachment = {
                    id: record.attachment_file_id,
                    name: record.attachment_file_name,
                    url: record.attachment_file_url
                };
                showCurrentAttachment(currentAttachment);
            } else {
                currentAttachment = null;
                document.getElementById('current-attachment').classList.add('hidden');
            }

            showModal();
        }

        async function confirmDelete() {
            if (!recordToDelete) return;

            const deleteBtn = document.getElementById('btn-confirm-delete');
            const spinner = document.getElementById('delete-spinner');
            deleteBtn.disabled = true;
            spinner.classList.remove('hidden');

            try {
                const result = await deleteRecordApi(recordToDelete.id);
                if (result && result.success) {
                    showToast('‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
                    hideDeleteModal();
                    await fetchAllRecords();
                } else {
                    showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö: ' + (result.error || ''), 'error');
                }
            } catch (err) {
                console.error('Error deleting record:', err);
                showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö', 'error');
            }

            deleteBtn.disabled = false;
            spinner.classList.add('hidden');
        }

        function applyFiltersAndRender() {
            const searchTerm = document.getElementById('filter-search').value.toLowerCase();
            const typeFilter = document.getElementById('filter-type').value;
            const statusFilter = document.getElementById('filter-status').value;

            filteredRecords = allRecords.filter(record => {
                const matchSearch = !searchTerm ||
                    (record.cooperative_name || '').toLowerCase().includes(searchTerm) ||
                    (record.document_topic || '').toLowerCase().includes(searchTerm);
                const matchType = !typeFilter || record.document_type === typeFilter;
                const matchStatus = !statusFilter || record.status === statusFilter;
                return matchSearch && matchType && matchStatus;
            });

            // Sort by created_at descending
            filteredRecords.sort((a, b) => new Date(b.created_at || 0) - new Date(a.created_at || 0));

            // Reset to first page when filters change
            currentPage = 1;

            renderTableWithPagination();
        }

        // ==================== PAGINATION FUNCTIONS ====================

        function renderTableWithPagination() {
            const totalRecords = filteredRecords.length;
            const totalPages = Math.ceil(totalRecords / pageSize);

            // Ensure currentPage is within bounds
            if (currentPage > totalPages) currentPage = totalPages || 1;
            if (currentPage < 1) currentPage = 1;

            // Calculate start and end indices
            const startIndex = (currentPage - 1) * pageSize;
            const endIndex = Math.min(startIndex + pageSize, totalRecords);

            // Get records for current page
            const pageRecords = filteredRecords.slice(startIndex, endIndex);

            // Render table with page records (pass startIndex for correct numbering)
            renderTable(pageRecords, startIndex);

            // Update pagination UI
            updatePaginationUI(totalRecords, totalPages, startIndex, endIndex);
        }

        function updatePaginationUI(totalRecords, totalPages, startIndex, endIndex) {
            const paginationContainer = document.getElementById('pagination-container');

            if (totalRecords === 0) {
                paginationContainer.classList.add('hidden');
                return;
            }

            paginationContainer.classList.remove('hidden');

            // Update info text
            document.getElementById('pagination-info').textContent =
                `‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ ${startIndex + 1}-${endIndex} ‡∏à‡∏≤‡∏Å ${totalRecords}`;

            // Update page numbers
            document.getElementById('current-page').textContent = currentPage;
            document.getElementById('total-pages').textContent = totalPages;

            // Update button states
            const btnFirst = document.getElementById('btn-first-page');
            const btnPrev = document.getElementById('btn-prev-page');
            const btnNext = document.getElementById('btn-next-page');
            const btnLast = document.getElementById('btn-last-page');

            btnFirst.disabled = currentPage === 1;
            btnPrev.disabled = currentPage === 1;
            btnNext.disabled = currentPage === totalPages;
            btnLast.disabled = currentPage === totalPages;
        }

        function goToPage(page) {
            const totalPages = Math.ceil(filteredRecords.length / pageSize);
            if (page < 1 || page > totalPages) return;
            currentPage = page;
            renderTableWithPagination();
        }

        function changePageSize(newSize) {
            pageSize = parseInt(newSize);
            currentPage = 1; // Reset to first page
            renderTableWithPagination();
        }

        function clearFilters() {
            document.getElementById('filter-search').value = '';
            document.getElementById('filter-type').value = '';
            document.getElementById('filter-status').value = '';
            applyFiltersAndRender();
        }

        function renderEmptyState() {
            const tbody = document.getElementById('table-body');
            tbody.innerHTML = `
        <tr>
          <td colspan="12" class="px-4 py-12 text-center text-gray-500">
            <svg class="w-12 h-12 mx-auto mb-3 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
            </svg>
            <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</p>
          </td>
        </tr>
      `;
        }

        function renderTable(records, startIndex = 0) {
            const tbody = document.getElementById('table-body');

            if (records.length === 0) {
                tbody.innerHTML = `
          <tr>
            <td colspan="12" class="px-4 py-12 text-center text-gray-500">
              <svg class="w-12 h-12 mx-auto mb-3 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
              </svg>
              <p>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç</p>
            </td>
          </tr>
        `;
                return;
            }

            tbody.innerHTML = records.map((record, index) => {
                const coopDays = calculateWorkingDays(record.receive_from_coop_date, record.send_back_to_coop_date);
                const groupDays = calculateWorkingDays(record.receive_from_admin_date, record.group_complete_date);

                let statusClass = 'status-pending';
                if (record.status === '‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß') statusClass = 'status-complete';
                else if (record.status === '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£') statusClass = 'status-processing';

                return `
          <tr class="table-row" data-id="${record.id}">
            <td class="px-4 py-3 text-sm text-gray-600">${startIndex + index + 1}</td>
            <td class="px-4 py-3 text-sm font-medium text-gray-800">${record.cooperative_name || '-'}</td>
            <td class="px-4 py-3 text-sm">
              <span class="px-2 py-1 rounded ${record.document_type === '‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö' ? 'bg-blue-100 text-blue-700' : 'bg-purple-100 text-purple-700'}">
                ${record.document_type || '-'}
              </span>
            </td>
            <td class="px-4 py-3 text-sm text-gray-600">${record.document_topic || '-'}</td>
            <td class="px-4 py-3 text-sm text-gray-600">${formatDate(record.receive_from_coop_date)}</td>
            <td class="px-4 py-3 text-sm text-gray-600">${formatDate(record.send_back_to_coop_date)}</td>
            <td class="px-4 py-3 text-sm text-center font-semibold ${coopDays !== null ? 'text-blue-600' : 'text-gray-400'}">${coopDays !== null ? coopDays + ' ‡∏ß‡∏±‡∏ô' : '-'}</td>
            <td class="px-4 py-3 text-sm text-gray-600">${formatDate(record.receive_from_admin_date)}</td>
            <td class="px-4 py-3 text-sm text-gray-600">${formatDate(record.group_complete_date)}</td>
            <td class="px-4 py-3 text-sm text-center font-semibold ${groupDays !== null ? 'text-green-600' : 'text-gray-400'}">${groupDays !== null ? groupDays + ' ‡∏ß‡∏±‡∏ô' : '-'}</td>
            <td class="px-4 py-3 text-sm">
              <span class="px-2 py-1 rounded text-xs font-medium ${statusClass}">${record.status || '-'}</span>
            </td>
            <td class="px-4 py-3 text-sm">
                ${record.attachment_file_url ?
                        `<a href="${record.attachment_file_url}" target="_blank" class="text-blue-600 hover:text-blue-800 flex items-center gap-1 group">
                        <svg class="w-4 h-4 group-hover:scale-110 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"></path></svg>
                        ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå
                    </a>` :
                        '<span class="text-gray-400">-</span>'
                    }
            </td>
            <td class="px-4 py-3 text-sm">
              <div class="flex gap-1">
                <button onclick="editRecord(allRecords.find(r => r.id === '${record.id}'))" class="p-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors" title="‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                  </svg>
                </button>
                <button onclick="showDeleteModal(allRecords.find(r => r.id === '${record.id}'))" class="p-1.5 text-red-600 hover:bg-red-50 rounded transition-colors" title="‡∏•‡∏ö">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                  </svg>
                </button>
              </div>
            </td>
          </tr>
        `;
            }).join('');
        }

        function updateStats() {
            const total = allRecords.length;
            const pending = allRecords.filter(r => r.status === '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£').length;
            const complete = allRecords.filter(r => r.status === '‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß').length;
            const processing = allRecords.filter(r => r.status === '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£').length;

            document.getElementById('stat-total').textContent = total;
            document.getElementById('stat-pending').textContent = pending;
            document.getElementById('stat-complete').textContent = complete;
            document.getElementById('stat-processing').textContent = processing;
        }

        function updateSummary() {
            const summarySection = document.getElementById('summary-section');
            const summaryContent = document.getElementById('summary-content');

            if (allRecords.length === 0) {
                summarySection.classList.add('hidden');
                return;
            }

            summarySection.classList.remove('hidden');

            // Group by cooperative
            const groupedByCooperative = {};
            allRecords.forEach(record => {
                const coopName = record.cooperative_name || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠';
                if (!groupedByCooperative[coopName]) {
                    groupedByCooperative[coopName] = {
                        ‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö: [],
                        ‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö: []
                    };
                }
                if (record.document_type === '‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö' || record.document_type === '‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö') {
                    groupedByCooperative[coopName][record.document_type].push(record);
                }
            });

            let html = '';
            Object.keys(groupedByCooperative).sort().forEach(coopName => {
                const docs = groupedByCooperative[coopName];
                const totalDocs = docs['‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö'].length + docs['‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö'].length;

                html += `
          <div class="border border-gray-200 rounded-lg p-4">
            <h4 class="font-semibold text-gray-800 mb-3 flex items-center gap-2">
              <span class="w-8 h-8 bg-blue-100 text-blue-700 rounded-full flex items-center justify-center text-sm font-bold">${totalDocs}</span>
              ${coopName}
            </h4>
            <div class="grid grid-cols-1 gap-4">
        `;

                if (docs['‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö'].length > 0) {
                    html += `
            <div class="bg-blue-50 rounded-lg p-3">
              <h5 class="font-medium text-blue-800 mb-2">üìã ‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö (${docs['‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö'].length})</h5>
              <ul class="space-y-1 text-sm text-blue-700 break-words">
                ${docs['‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö'].map(d => `<li>‚Ä¢ ${d.document_topic || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠'}</li>`).join('')}
              </ul>
            </div>
          `;
                }

                if (docs['‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö'].length > 0) {
                    html += `
            <div class="bg-purple-50 rounded-lg p-3">
              <h5 class="font-medium text-purple-800 mb-2">üìú ‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö (${docs['‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö'].length})</h5>
              <ul class="space-y-1 text-sm text-purple-700 break-words">
                ${docs['‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö'].map(d => `<li>‚Ä¢ ${d.document_topic || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠'}</li>`).join('')}
              </ul>
            </div>
          `;
                }

                html += `
            </div>
          </div>
        `;
            });

            summaryContent.innerHTML = html;
        }

        // ==================== EVENT LISTENERS ====================

        function setupEventListeners() {
            // Add new button
            document.getElementById('btn-add-new').addEventListener('click', () => {
                isEditing = false;
                document.getElementById('modal-title').textContent = '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà';
                document.getElementById('form-record').reset();
                document.getElementById('record-id').value = '';
                document.getElementById('coop-days-info').classList.add('hidden');
                document.getElementById('group-days-info').classList.add('hidden');

                // Reset file upload
                selectedFile = null;
                currentAttachment = null;
                resetFileUploadUI();
                document.getElementById('current-attachment').classList.add('hidden');

                showModal();

                // Initialize Doc Items for New Record
                const container = document.getElementById('doc-items-container');
                container.innerHTML = '';
                container.appendChild(createDocItemRow()); // Add one empty row
                document.getElementById('btn-add-doc-item').classList.remove('hidden');
            });

            // Add Doc Item Button
            document.getElementById('btn-add-doc-item').addEventListener('click', () => {
                const container = document.getElementById('doc-items-container');
                container.appendChild(createDocItemRow());
            });

            // Modal close buttons
            document.getElementById('btn-close-modal').addEventListener('click', hideModal);
            document.getElementById('btn-cancel').addEventListener('click', hideModal);
            document.getElementById('modal-backdrop').addEventListener('click', hideModal);

            // Form submit
            document.getElementById('form-record').addEventListener('submit', handleFormSubmit);

            // Date change listeners for auto-calculation and synchronization
            document.getElementById('input-receive-coop').addEventListener('change', updateCoopDaysInfo);

            document.getElementById('input-send-coop').addEventListener('change', function () {
                updateCoopDaysInfo();
                // Sync to Group Completed Date
                document.getElementById('input-group-complete').value = this.value;
                updateGroupDaysInfo();
            });

            document.getElementById('input-receive-admin').addEventListener('change', updateGroupDaysInfo);

            document.getElementById('input-group-complete').addEventListener('change', function () {
                updateGroupDaysInfo();
                // Sync to Returned to Cooperative Date
                document.getElementById('input-send-coop').value = this.value;
                updateCoopDaysInfo();
            });

            // Filters
            document.getElementById('filter-search').addEventListener('input', applyFiltersAndRender);
            document.getElementById('filter-type').addEventListener('change', applyFiltersAndRender);
            document.getElementById('filter-status').addEventListener('change', applyFiltersAndRender);
            document.getElementById('btn-clear-filter').addEventListener('click', clearFilters);

            // Pagination
            document.getElementById('page-size').addEventListener('change', (e) => changePageSize(e.target.value));
            document.getElementById('btn-first-page').addEventListener('click', () => goToPage(1));
            document.getElementById('btn-prev-page').addEventListener('click', () => goToPage(currentPage - 1));
            document.getElementById('btn-next-page').addEventListener('click', () => goToPage(currentPage + 1));
            document.getElementById('btn-last-page').addEventListener('click', () => {
                const totalPages = Math.ceil(filteredRecords.length / pageSize);
                goToPage(totalPages);
            });

            // Delete modal
            document.getElementById('btn-cancel-delete').addEventListener('click', hideDeleteModal);
            document.getElementById('btn-confirm-delete').addEventListener('click', confirmDelete);

            // File Upload Listeners
            setupFileUploadListeners();
        }

        function setupFileUploadListeners() {
            const dropZone = document.getElementById('file-drop-zone');
            const fileInput = document.getElementById('file-input');
            const btnCancelUpload = document.getElementById('btn-cancel-upload');
            const btnRemoveAttachment = document.getElementById('btn-remove-attachment');

            // Handling drag and drop events
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, preventDefaults, false);
            });

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            dropZone.addEventListener('dragenter', () => dropZone.classList.add('border-blue-500', 'bg-blue-50'));
            dropZone.addEventListener('dragover', () => dropZone.classList.add('border-blue-500', 'bg-blue-50'));
            dropZone.addEventListener('dragleave', () => dropZone.classList.remove('border-blue-500', 'bg-blue-50'));
            dropZone.addEventListener('drop', (e) => {
                dropZone.classList.remove('border-blue-500', 'bg-blue-50');
                const dt = e.dataTransfer;
                const files = dt.files;
                handleFiles(files);
            });

            // Click to select
            dropZone.addEventListener('click', (e) => {
                if (e.target !== btnCancelUpload) fileInput.click();
            });

            fileInput.addEventListener('change', function () {
                handleFiles(this.files);
            });

            btnCancelUpload.addEventListener('click', (e) => {
                e.stopPropagation();
                selectedFile = null;
                fileInput.value = '';
                resetFileUploadUI();
            });

            btnRemoveAttachment.addEventListener('click', async () => {
                if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                    if (currentAttachment && currentAttachment.id) {
                        // Optional: Call API to delete file from Drive immediately
                        // For now we just remove reference
                    }
                    currentAttachment = null;
                    document.getElementById('current-attachment').classList.add('hidden');
                    document.getElementById('file-drop-zone').classList.remove('hidden');
                }
            });
        }

        function handleFiles(files) {
            if (files.length > 0) {
                const file = files[0];
                // Validate file size (10MB)
                if (file.size > 10 * 1024 * 1024) {
                    showToast('‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 10MB', 'error');
                    return;
                }

                selectedFile = file;
                displaySelectedFile(file);
            }
        }

        function displaySelectedFile(file) {
            const dropZoneContent = document.getElementById('drop-zone-content');
            const fileDisplay = document.getElementById('selected-file-display');
            const fileName = document.getElementById('selected-file-name');
            const fileSize = document.getElementById('selected-file-size');

            dropZoneContent.classList.add('hidden');
            fileDisplay.classList.remove('hidden');

            fileName.textContent = file.name;
            fileSize.textContent = (file.size / 1024 / 1024).toFixed(2) + ' MB';
        }

        function resetFileUploadUI() {
            const dropZoneContent = document.getElementById('drop-zone-content');
            const fileDisplay = document.getElementById('selected-file-display');
            const fileInput = document.getElementById('file-input');

            dropZoneContent.classList.remove('hidden');
            fileDisplay.classList.add('hidden');
            fileInput.value = '';

            // If we have an existing attachment, hide dropzone
            if (currentAttachment) {
                document.getElementById('file-drop-zone').classList.add('hidden');
            } else {
                document.getElementById('file-drop-zone').classList.remove('hidden');
            }
        }

        function showCurrentAttachment(attachment) {
            const container = document.getElementById('current-attachment');
            const link = document.getElementById('attachment-link');

            link.textContent = attachment.name;
            link.href = attachment.url;
            container.classList.remove('hidden');
            document.getElementById('file-drop-zone').classList.add('hidden');
        }

        // ==================== INITIALIZE APP ====================

        async function initApp() {
            setupEventListeners();

            // Check if SCRIPT_URL is configured
            if (SCRIPT_URL === 'YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL_HERE') {
                showToast('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ SCRIPT_URL ‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô', 'error');
                renderEmptyState();
                return;
            }

            // Initialize cooperative names datalist
            initCoopNamesList();

            await fetchAllRecords();
        }

        // Start the app
        initApp();
    </script>
</body>

</html>