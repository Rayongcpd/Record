<!DOCTYPE html>
<html lang="th" class="h-full">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏∏‡∏°‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå</title>
    <meta name="description" content="‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö/‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏à‡∏±‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            box-sizing: border-box;
            font-family: 'Prompt', sans-serif;
        }

        .gradient-header {
            background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 50%, #3d7ab5 100%);
        }

        .card-shadow {
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        /* Removed generic hover to allow specific status hovers */
        /* .table-row:hover {
            background-color: #f0f7ff;
        } */

        .status-pending {
            background: #fef3c7;
            color: #92400e;
        }

        .status-complete {
            background: #d1fae5;
            color: #065f46;
        }

        .status-processing {
            background: #dbeafe;
            color: #1e40af;
        }

        .modal-backdrop {
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }

        input[type="date"]::-webkit-calendar-picker-indicator {
            cursor: pointer;
        }

        .loading-overlay {
            background: rgba(255, 255, 255, 0.8);
        }

        /* Status Row Styles */
        .row-pending {
            background-color: #fffbeb;
            /* yellow-50 */
        }

        .row-pending:hover {
            background-color: #fef3c7;
            /* yellow-100 */
        }

        .row-processing {
            background-color: #eff6ff;
            /* blue-50 */
        }

        .row-processing:hover {
            background-color: #dbeafe;
            /* blue-100 */
        }

        .row-complete {
            background-color: #f0fdf4;
            /* green-50 */
        }

        .row-complete:hover {
            background-color: #dcfce7;
            /* green-100 */
        }
    </style>
</head>

<body class="h-full bg-gray-50">
    <div id="app" class="h-full w-full overflow-auto">
        <!-- Loading Overlay -->
        <div id="loading-overlay" class="fixed inset-0 z-[100] flex items-center justify-center loading-overlay hidden">
            <div class="text-center">
                <svg class="w-12 h-12 animate-spin text-blue-600 mx-auto" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor"
                        d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                    </path>
                </svg>
                <p class="mt-2 text-gray-600">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</p>
            </div>
        </div>

        <!-- Header -->
        <header class="gradient-header text-white py-6 px-4 shadow-lg">
            <div class="max-w-7xl mx-auto">
                <div class="flex items-center gap-3">
                    <svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z">
                        </path>
                    </svg>
                    <div>
                        <h1 class="text-2xl font-bold">‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏∏‡∏°‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå</h1>
                        <p class="text-blue-100 text-sm">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏à‡∏±‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå</p>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="bg-white shadow-sm border-b border-gray-200 sticky top-0 z-30">
            <div class="max-w-7xl mx-auto px-4">
                <div class="flex space-x-8 overflow-x-auto">
                    <button onclick="switchView('dashboard')"
                        class="nav-item whitespace-nowrap border-b-2 border-blue-600 text-blue-600 py-4 px-1 text-sm font-medium transition-colors"
                        id="nav-dashboard">
                        <span class="flex items-center gap-2">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6">
                                </path>
                            </svg>
                            ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
                        </span>
                    </button>
                    <button onclick="switchView('daily-ops')"
                        class="nav-item whitespace-nowrap border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 py-4 px-1 text-sm font-medium transition-colors"
                        id="nav-daily-ops">
                        <span class="flex items-center gap-2">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01">
                                </path>
                            </svg>
                            ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô
                        </span>
                    </button>
                    <button onclick="switchView('registry')"
                        class="nav-item whitespace-nowrap border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 py-4 px-1 text-sm font-medium transition-colors"
                        id="nav-registry">
                        <span class="flex items-center gap-2">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z">
                                </path>
                            </svg>
                            ‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏∏‡∏°
                        </span>
                    </button>
                    <button onclick="switchView('calendar')"
                        class="nav-item whitespace-nowrap border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 py-4 px-1 text-sm font-medium transition-colors"
                        id="nav-calendar">
                        <span class="flex items-center gap-2">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z">
                                </path>
                            </svg>
                            ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô
                        </span>
                    </button>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="max-w-7xl mx-auto px-4 py-6">

            <!-- DASHBOARD VIEW -->
            <div id="view-dashboard" class="space-y-8 animate-fade-in">
                <!-- Alerts Section -->
                <div id="dashboard-alerts" class="mb-6 hidden"></div>

                <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
                    <!-- Left: Recent Operations (Wider) -->
                    <div class="lg:col-span-7 space-y-4">
                        <div class="flex items-center justify-between flex-wrap gap-2">
                            <h3 class="text-xl font-bold text-gray-800 flex items-center gap-2">
                                <span class="bg-blue-100 p-2 rounded-lg text-blue-600">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                </span>
                                ‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
                            </h3>
                            <div class="flex items-center gap-2">
                                <select id="dashboard-time-filter" onchange="renderDashboard()"
                                    class="text-sm border border-gray-300 rounded-lg px-3 py-1.5 bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                                    <option value="week">‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ô‡∏µ‡πâ</option>
                                    <option value="month" selected>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</option>
                                    <option value="year">‡∏õ‡∏µ‡∏ô‡∏µ‡πâ</option>
                                </select>
                                <button onclick="switchView('daily-ops')"
                                    class="text-sm text-blue-600 hover:text-blue-800 font-medium hover:underline">‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                            </div>
                        </div>

                        <div id="dashboard-daily-content"
                            class="bg-white rounded-2xl shadow-sm border border-gray-100 p-2 min-h-[300px]">
                            <p class="text-gray-400 text-center py-12 flex flex-col items-center">
                                <svg class="w-12 h-12 mb-3 opacity-20" fill="none" stroke="currentColor"
                                    viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...
                            </p>
                        </div>
                    </div>

                    <!-- Right: Registry Stats (Narrower) -->
                    <div class="lg:col-span-5 space-y-4">
                        <h3 class="text-xl font-bold text-gray-800 flex items-center gap-2">
                            <span class="bg-indigo-100 p-2 rounded-lg text-indigo-600">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z">
                                    </path>
                                </svg>
                            </span>
                            ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏∏‡∏°
                        </h3>

                        <div id="dashboard-registry-stats" class="grid grid-cols-2 gap-4">
                            <!-- Injected by JS -->
                        </div>

                        <!-- Quick Summary Chart Placeholder (Can be added later) -->
                        <div
                            class="bg-gradient-to-br from-gray-50 to-gray-100 rounded-2xl p-6 border border-gray-200 mt-4 text-center">
                            <p class="text-sm text-gray-500 mb-2">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Ç‡∏≠‡∏á‡∏á‡∏≤‡∏ô</p>
                            <div class="flex items-center justify-center gap-2">
                                <div class="w-32 h-2 bg-gray-200 rounded-full overflow-hidden">
                                    <div id="progress-bar-success"
                                        class="h-full bg-green-500 w-0 transition-all duration-1000"></div>
                                </div>
                                <span id="progress-text-success" class="text-xs font-bold text-gray-700">0%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- DAILY OPS VIEW -->
            <div id="view-daily-ops" class="hidden space-y-6 animate-fade-in">
                <!-- Header & Actions -->
                <div class="flex justify-between items-center bg-white p-4 rounded-xl card-shadow">
                    <h2 class="text-xl font-bold text-gray-800">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</h2>
                    <button onclick="openDailyOpModal()"
                        class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4">
                            </path>
                        </svg>
                        ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà
                    </button>
                </div>

                <!-- Daily Ops Content -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- List of Ops -->
                    <div class="lg:col-span-3">
                        <div class="bg-white rounded-xl card-shadow overflow-hidden">
                            <div class="p-4 border-b border-gray-100 flex justify-between items-center">
                                <h3 class="font-semibold text-gray-700">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h3>
                                <input type="date" id="daily-filter-date"
                                    class="border border-gray-300 rounded px-2 py-1 text-sm">
                            </div>
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-sm text-gray-600 font-medium">‡πÄ‡∏ß‡∏•‡∏≤</th>
                                            <th class="px-4 py-3 text-left text-sm text-gray-600 font-medium">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°
                                            </th>
                                            <th class="px-4 py-3 text-left text-sm text-gray-600 font-medium">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà
                                            </th>
                                            <th class="px-4 py-3 text-left text-sm text-gray-600 font-medium">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                            <th class="px-4 py-3 text-left text-sm text-gray-600 font-medium">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody id="daily-ops-table-body" class="divide-y divide-gray-100">
                                        <tr>
                                            <td colspan="5" class="p-4 text-center text-gray-500">
                                                ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- REGISTRY VIEW (Existing Content Wrapped) -->
            <div id="view-registry" class="hidden">
                <!-- Stats Cards -->

                <!-- Stats Cards Removed as per user request -->


                <!-- Add New Button -->
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold text-gray-800">‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏∏‡∏°‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö/‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö</h2>
                    <button id="btn-add-new"
                        class="bg-blue-600 hover:bg-blue-700 text-white px-5 py-2.5 rounded-lg font-medium flex items-center gap-2 transition-colors">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4">
                            </path>
                        </svg>
                        ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà
                    </button>
                </div>

                <!-- Filter -->
                <div class="bg-white rounded-xl p-4 card-shadow mb-4">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-600 mb-1">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå</label>
                            <input type="text" id="filter-search" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå..."
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-600 mb-1">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</label>
                            <select id="filter-type"
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                                <option value="‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö">‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö</option>
                                <option value="‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö">‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-600 mb-1">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
                            <select id="filter-status"
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                                <option value="‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                                <option value="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                                <option value="‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß">‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß</option>
                            </select>
                        </div>
                        <div class="flex items-end">
                            <button id="btn-clear-filter"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á</button>
                        </div>
                    </div>
                </div>

                <!-- Table -->
                <div class="bg-white rounded-xl card-shadow overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gray-50 border-b border-gray-200">
                                <tr>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå
                                    </th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">
                                        ‡∏™‡∏ô‡∏á.‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏£‡πá‡∏à
                                    </th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">
                                        ‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£<br>(‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå)
                                    </th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£
                                    </th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">
                                        ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏£‡πá‡∏à
                                    </th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">
                                        ‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£<br>(‡∏Å‡∏•‡∏∏‡πà‡∏°)
                                    </th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö</th>
                                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                                </tr>
                            </thead>
                            <tbody id="table-body" class="divide-y divide-gray-100">
                                <tr>
                                    <td colspan="12" class="px-4 py-12 text-center text-gray-500">
                                        <svg class="w-12 h-12 mx-auto mb-3 text-gray-300" fill="none"
                                            stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z">
                                            </path>
                                        </svg>
                                        <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Pagination -->
                <div id="pagination-container"
                    class="mt-4 bg-white rounded-xl p-4 card-shadow flex flex-col sm:flex-row items-center justify-between gap-4 hidden">
                    <div class="flex items-center gap-2 text-sm text-gray-600">
                        <span>‡πÅ‡∏™‡∏î‡∏á:</span>
                        <select id="page-size"
                            class="px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="10">10</option>
                            <option value="20">20</option>
                            <option value="50">50</option>
                            <option value="100">100</option>
                        </select>
                        <span>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <span id="pagination-info" class="text-sm text-gray-600 mr-2">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ 1-10 ‡∏à‡∏≤‡∏Å 100</span>
                        <button id="btn-first-page"
                            class="p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"
                            title="‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M11 19l-7-7 7-7m8 14l-7-7 7-7"></path>
                            </svg>
                        </button>
                        <button id="btn-prev-page"
                            class="p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"
                            title="‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M15 19l-7-7 7-7">
                                </path>
                            </svg>
                        </button>
                        <span class="px-3 py-1.5 bg-blue-50 text-blue-700 rounded-lg font-medium text-sm">
                            ‡∏´‡∏ô‡πâ‡∏≤ <span id="current-page">1</span> / <span id="total-pages">1</span>
                        </span>
                        <button id="btn-next-page"
                            class="p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"
                            title="‡∏ñ‡∏±‡∏î‡πÑ‡∏õ">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7">
                                </path>
                            </svg>
                        </button>
                        <button id="btn-last-page"
                            class="p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"
                            title="‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M13 5l7 7-7 7M5 5l7 7-7 7"></path>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Summary Section -->
                <div id="summary-section" class="mt-6 bg-white rounded-xl p-6 card-shadow hidden">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2">
                        <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z">
                            </path>
                        </svg>
                        ‡∏™‡∏£‡∏∏‡∏õ‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏∏‡∏°
                    </h3>
                    <div id="summary-content" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
                </div>
            </div> <!-- End view-registry -->

            <!-- CALENDAR VIEW -->
            <div id="view-calendar" class="hidden space-y-6 animate-fade-in">
                <div class="bg-white rounded-xl card-shadow p-6">
                    <!-- Calendar Header -->
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl font-bold text-gray-800 flex items-center gap-2">
                            <span class="bg-indigo-100 p-2 rounded-lg text-indigo-600">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z">
                                    </path>
                                </svg>
                            </span>
                            <span id="calendar-month-year">...</span>
                        </h2>
                        <div class="flex items-center gap-2">
                            <button onclick="changeMonth(-1)"
                                class="p-2 hover:bg-gray-100 rounded-lg text-gray-600 transition-colors">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M15 19l-7-7 7-7"></path>
                                </svg>
                            </button>
                            <button onclick="goToToday()"
                                class="px-3 py-1 text-sm bg-blue-50 text-blue-600 rounded-lg font-medium hover:bg-blue-100 transition-colors">
                                ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ
                            </button>
                            <button onclick="changeMonth(1)"
                                class="p-2 hover:bg-gray-100 rounded-lg text-gray-600 transition-colors">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M9 5l7 7-7 7"></path>
                                </svg>
                            </button>
                        </div>
                    </div>

                    <!-- Calendar Grid -->
                    <div class="grid grid-cols-7 gap-px bg-gray-200 rounded-lg overflow-hidden border border-gray-200">
                        <!-- Days Header -->
                        <div class="bg-gray-50 p-2 text-center text-sm font-semibold text-gray-700">‡∏≠‡∏≤.</div>
                        <div class="bg-gray-50 p-2 text-center text-sm font-semibold text-gray-700">‡∏à.</div>
                        <div class="bg-gray-50 p-2 text-center text-sm font-semibold text-gray-700">‡∏≠.</div>
                        <div class="bg-gray-50 p-2 text-center text-sm font-semibold text-gray-700">‡∏û.</div>
                        <div class="bg-gray-50 p-2 text-center text-sm font-semibold text-gray-700">‡∏û‡∏§.</div>
                        <div class="bg-gray-50 p-2 text-center text-sm font-semibold text-gray-700">‡∏®.</div>
                        <div class="bg-gray-50 p-2 text-center text-sm font-semibold text-gray-700">‡∏™.</div>

                        <!-- Calendar Days will be injected here -->
                        <div id="calendar-grid" class="col-span-7 grid grid-cols-7 gap-px bg-gray-200">
                            <!-- JS will populate this -->
                        </div>
                    </div>
                </div>

                <!-- Legend -->
                <div class="flex flex-wrap gap-4 text-sm text-gray-600 px-2 justify-center">
                    <div class="flex items-center gap-1.5">
                        <span class="w-3 h-3 rounded-full bg-blue-500"></span> ‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå
                    </div>
                    <div class="flex items-center gap-1.5">
                        <span class="w-3 h-3 rounded-full bg-green-500"></span> ‡∏™‡∏ô‡∏á.‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏£‡πá‡∏à
                    </div>
                    <div class="flex items-center gap-1.5">
                        <span class="w-3 h-3 rounded-full bg-orange-500"></span> ‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£
                    </div>
                    <div class="flex items-center gap-1.5">
                        <span class="w-3 h-3 rounded-full bg-purple-500"></span> ‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏™‡∏£‡πá‡∏à
                    </div>
                    <div class="flex items-center gap-1.5">
                        <span class="w-3 h-3 rounded-full bg-gray-500"></span> ‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô
                    </div>
                </div>
            </div>

            <!-- Calendar Event Modal -->
            <div id="calendar-modal" class="fixed inset-0 z-50 hidden">
                <div class="modal-backdrop absolute inset-0" onclick="closeCalendarModal()"></div>
                <div class="relative flex items-center justify-center min-h-full p-4">
                    <div class="bg-white rounded-xl shadow-2xl w-full max-w-md relative max-h-[80vh] overflow-y-auto">
                        <div
                            class="sticky top-0 bg-white border-b border-gray-100 px-6 py-4 rounded-t-xl flex justify-between items-center">
                            <h3 id="calendar-modal-date" class="font-bold text-gray-800 text-lg">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</h3>
                            <button onclick="closeCalendarModal()" class="text-gray-400 hover:text-gray-600">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                        <div id="calendar-modal-content" class="p-6 space-y-3">
                            <!-- Events injected here -->
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Daily Ops Modal -->
        <div id="daily-ops-modal" class="fixed inset-0 z-50 hidden">
            <div class="modal-backdrop absolute inset-0"></div>
            <div class="relative flex items-center justify-center min-h-full p-4">
                <div class="bg-white rounded-2xl shadow-2xl w-full max-w-lg relative max-h-[90vh] overflow-y-auto">
                    <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 rounded-t-2xl">
                        <h2 id="daily-modal-title" class="text-xl font-semibold text-gray-800">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà</h2>
                        <button onclick="closeDailyOpModal()"
                            class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    <form id="form-daily-op" class="p-6 space-y-4">
                        <input type="hidden" id="daily-id">

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà <span
                                    class="text-red-500">*</span></label>
                            <input type="date" id="daily-date" required
                                class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">‡πÄ‡∏ß‡∏•‡∏≤ <span
                                    class="text-red-500">*</span></label>
                            <input type="time" id="daily-time" required
                                class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° <span
                                    class="text-red-500">*</span></label>
                            <input type="text" id="daily-activity" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö..."
                                class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</label>
                            <textarea id="daily-details" rows="2" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..."
                                class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"></textarea>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà <span
                                    class="text-red-500">*</span></label>
                            <input type="text" id="daily-location" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå..."
                                class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
                            <select id="daily-status"
                                class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                                <option value="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                                <option value="‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß">‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß</option>
                            </select>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
                            <textarea id="daily-notes" rows="2"
                                class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"></textarea>
                        </div>

                        <div class="flex gap-3 pt-4 border-t border-gray-200">
                            <button type="button" onclick="closeDailyOpModal()"
                                class="flex-1 px-4 py-2.5 border border-gray-300 rounded-lg hover:bg-gray-50 font-medium">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                            <button type="submit" id="btn-save-daily"
                                class="flex-1 px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium flex items-center justify-center gap-2">
                                <span>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</span>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Add/Edit Modal -->
        <div id="modal" class="fixed inset-0 z-50 hidden">
            <div class="modal-backdrop absolute inset-0" id="modal-backdrop"></div>
            <div class="relative flex items-center justify-center min-h-full p-4">
                <div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto relative">
                    <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 rounded-t-2xl">
                        <h2 id="modal-title" class="text-xl font-semibold text-gray-800">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà</h2>
                        <button id="btn-close-modal" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    <form id="form-record" class="p-6 space-y-4">
                        <input type="hidden" id="record-id">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="md:col-span-2">
                                <label class="block text-sm font-medium text-gray-700 mb-1">‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå <span
                                        class="text-red-500">*</span></label>
                                <input type="text" id="input-coop-name" list="coop-names-list" required
                                    class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                    placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå..." autocomplete="off">
                                <datalist id="coop-names-list"></datalist>
                            </div>
                            <div class="md:col-span-2">
                                <div class="flex items-center justify-between mb-2">
                                    <label class="block text-sm font-medium text-gray-700">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ <span
                                            class="text-red-500">*</span></label>
                                    <button type="button" id="btn-add-doc-item"
                                        class="text-sm text-blue-600 hover:text-blue-800 font-medium flex items-center gap-1">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M12 4v16m8-8H4"></path>
                                        </svg>
                                        ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
                                    </button>
                                </div>
                                <div id="doc-items-container" class="space-y-3">
                                    <!-- Dynamic rows will be here -->
                                </div>
                            </div>
                        </div>

                        <div class="border-t border-gray-200 pt-4">
                            <h4 class="font-medium text-gray-800 mb-3 flex items-center gap-2">
                                <span class="bg-blue-100 text-blue-700 px-2 py-1 rounded text-sm">1</span>
                                ‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö-‡∏™‡πà‡∏á‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå
                            </h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label
                                        class="block text-sm font-medium text-gray-700 mb-1">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏à‡∏≤‡∏Å‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå</label>
                                    <input type="date" id="input-receive-coop"
                                        class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div>
                                    <label
                                        class="block text-sm font-medium text-gray-700 mb-1">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå</label>
                                    <input type="date" id="input-send-coop"
                                        class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                </div>
                            </div>
                            <div id="coop-days-info" class="mt-2 text-sm text-blue-600 hidden"></div>
                        </div>

                        <div class="border-t border-gray-200 pt-4">
                            <h4 class="font-medium text-gray-800 mb-3 flex items-center gap-2">
                                <span class="bg-green-100 text-green-700 px-2 py-1 rounded text-sm">2</span>
                                ‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏à‡∏±‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏Ø
                            </h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label
                                        class="block text-sm font-medium text-gray-700 mb-1">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏Ø</label>
                                    <input type="date" id="input-receive-admin"
                                        class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div>
                                    <label
                                        class="block text-sm font-medium text-gray-700 mb-1">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏£‡πá‡∏à</label>
                                    <input type="date" id="input-group-complete"
                                        class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                </div>
                            </div>
                            <div id="group-days-info" class="mt-2 text-sm text-green-600 hidden"></div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
                            <select id="input-status"
                                class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                                <option value="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                                <option value="‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß">‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß</option>
                            </select>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
                            <textarea id="input-notes" rows="2"
                                class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..."></textarea>
                        </div>

                        <!-- File Attachment Section -->
                        <div class="border-t border-gray-200 pt-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                üìé ‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö
                            </label>
                            <div id="attachment-container">
                                <!-- Existing Attachment -->
                                <div id="current-attachment"
                                    class="hidden mb-3 p-3 bg-gray-50 rounded-lg flex items-center justify-between border border-gray-200">
                                    <div class="flex items-center gap-2 overflow-hidden">
                                        <svg class="w-5 h-5 text-blue-600 flex-shrink-0" fill="none"
                                            stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13">
                                            </path>
                                        </svg>
                                        <a id="attachment-link" href="#" target="_blank"
                                            class="text-blue-600 hover:underline truncate"></a>
                                    </div>
                                    <button type="button" id="btn-remove-attachment"
                                        class="text-red-500 hover:text-red-700 p-1 rounded hover:bg-red-50 transition-colors"
                                        title="‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16">
                                            </path>
                                        </svg>
                                    </button>
                                </div>

                                <!-- Drop zone -->
                                <div id="file-drop-zone"
                                    class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-500 hover:bg-blue-50 transition-all cursor-pointer">
                                    <div id="drop-zone-content">
                                        <svg class="w-10 h-10 mx-auto text-gray-400 mb-2" fill="none"
                                            stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12">
                                            </path>
                                        </svg>
                                        <p class="text-sm text-gray-600">‡∏•‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà ‡∏´‡∏£‡∏∑‡∏≠ <span
                                                class="text-blue-600 font-medium">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå</span></p>
                                        <p class="text-xs text-gray-400 mt-1">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö: PDF, JPG, PNG, DOC, DOCX
                                            (‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 10MB)</p>
                                    </div>
                                    <div id="selected-file-display" class="hidden">
                                        <p class="text-sm font-medium text-gray-800 break-all" id="selected-file-name">
                                        </p>
                                        <p class="text-xs text-gray-500 mt-1" id="selected-file-size"></p>
                                        <button type="button" id="btn-cancel-upload"
                                            class="mt-2 text-xs text-red-600 hover:text-red-800 underline">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                                    </div>
                                    <input type="file" id="file-input" class="hidden"
                                        accept=".pdf,.jpg,.jpeg,.png,.doc,.docx">
                                </div>

                                <!-- Progress bar -->
                                <div id="upload-progress" class="hidden mt-3">
                                    <div class="flex items-center justify-between mb-1">
                                        <span class="text-xs font-medium text-blue-700">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î...</span>
                                        <span id="progress-text" class="text-xs font-medium text-blue-700">0%</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                                        <div id="progress-bar"
                                            class="bg-blue-600 h-2.5 rounded-full transition-all duration-300"
                                            style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="flex gap-3 pt-4 border-t border-gray-200">
                            <button type="button" id="btn-cancel"
                                class="flex-1 px-4 py-2.5 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                            <button type="submit" id="btn-save"
                                class="flex-1 px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors font-medium flex items-center justify-center gap-2">
                                <span>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</span>
                                <svg id="save-spinner" class="w-5 h-5 animate-spin hidden" fill="none"
                                    viewBox="0 0 24 24">
                                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor"
                                        stroke-width="4"></circle>
                                    <path class="opacity-75" fill="currentColor"
                                        d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                                    </path>
                                </svg>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Delete Confirmation -->
        <div id="delete-modal" class="fixed inset-0 z-50 hidden">
            <div class="modal-backdrop absolute inset-0"></div>
            <div class="relative flex items-center justify-center min-h-full p-4">
                <div class="bg-white rounded-xl shadow-2xl w-full max-w-md p-6 relative">
                    <div class="text-center">
                        <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <svg class="w-8 h-8 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16">
                                </path>
                            </svg>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-2">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö</h3>
                        <p class="text-gray-600 mb-6">‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ</p>
                        <div class="flex gap-3">
                            <button id="btn-cancel-delete"
                                class="flex-1 px-4 py-2.5 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                            <button id="btn-confirm-delete"
                                class="flex-1 px-4 py-2.5 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors font-medium flex items-center justify-center gap-2">
                                <span>‡∏•‡∏ö</span>
                                <svg id="delete-spinner" class="w-5 h-5 animate-spin hidden" fill="none"
                                    viewBox="0 0 24 24">
                                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor"
                                        stroke-width="4"></circle>
                                    <path class="opacity-75" fill="currentColor"
                                        d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                                    </path>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- View Details Modal -->
        <div id="view-details-modal" class="fixed inset-0 z-50 hidden">
            <div class="modal-backdrop absolute inset-0 bg-gray-900 bg-opacity-50 transition-opacity"
                onclick="closeViewDetailsModal()"></div>
            <div class="relative flex items-center justify-center min-h-full p-4 pointer-events-none">
                <div
                    class="bg-white rounded-2xl shadow-2xl w-full max-w-md relative overflow-hidden pointer-events-auto transform transition-all scale-100">
                    <div class="bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-4 flex justify-between items-center">
                        <h3 class="text-lg font-bold text-white">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h3>
                        <button onclick="closeViewDetailsModal()"
                            class="text-blue-100 hover:text-white transition-colors">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    <div class="p-6 space-y-4">
                        <div>
                            <p class="text-xs text-gray-500 mb-1">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</p>
                            <p id="view-activity" class="text-lg font-semibold text-gray-800"></p>
                        </div>
                        <div>
                            <p class="text-xs text-gray-500 mb-1">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</p>
                            <div id="view-details"
                                class="bg-gray-50 rounded-lg p-3 text-sm text-gray-700 min-h-[60px] whitespace-pre-wrap">
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <p class="text-xs text-gray-500 mb-1">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà-‡πÄ‡∏ß‡∏•‡∏≤</p>
                                <p id="view-datetime" class="text-sm font-medium text-gray-800"></p>
                            </div>
                            <div>
                                <p class="text-xs text-gray-500 mb-1">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</p>
                                <p id="view-location" class="text-sm font-medium text-gray-800"></p>
                            </div>
                        </div>
                        <div>
                            <p class="text-xs text-gray-500 mb-1">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</p>
                            <span id="view-status" class="inline-block px-2 py-1 rounded text-xs font-medium"></span>
                        </div>
                    </div>
                    <div class="bg-gray-50 px-6 py-3 flex justify-end">
                        <button onclick="closeViewDetailsModal()"
                            class="px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-lg text-sm font-medium transition-colors">‡∏õ‡∏¥‡∏î</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Toast -->
        <div id="toast"
            class="fixed bottom-4 right-4 transform translate-y-20 opacity-0 transition-all duration-300 z-50">
            <div class="bg-gray-800 text-white px-6 py-3 rounded-lg shadow-lg flex items-center gap-3">
                <svg id="toast-icon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                <span id="toast-message">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</span>
            </div>
        </div>
    </div>

    <script>
        // ==================== CONFIG ====================
        // üî¥ ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô URL ‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô Web App URL ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å Deploy
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbygBTVqnvvc7cTwf8YIQCQpJ5xLKU7Z4TEuycKCcQP4UPfo6uXeONMUBwMxRRhD7C6xtQ/exec';

        // Thai Public Holidays 2024-2026 (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡πÉ‡∏ô Frontend)
        const PUBLIC_HOLIDAYS = [
            // 2024
            '2024-01-01', '2024-01-02', '2024-02-26', '2024-04-06', '2024-04-08',
            '2024-04-13', '2024-04-14', '2024-04-15', '2024-04-16', '2024-05-01',
            '2024-05-04', '2024-05-06', '2024-05-22', '2024-06-03', '2024-07-20',
            '2024-07-21', '2024-07-22', '2024-07-28', '2024-07-29', '2024-08-12',
            '2024-10-13', '2024-10-14', '2024-10-23', '2024-12-05', '2024-12-10',
            '2024-12-31',
            // 2025
            '2025-01-01', '2025-02-14', '2025-04-06', '2025-04-07', '2025-04-13',
            '2025-04-14', '2025-04-15', '2025-05-01', '2025-05-04', '2025-05-11',
            '2025-05-12', '2025-06-03', '2025-07-10', '2025-07-28', '2025-08-12',
            '2025-10-13', '2025-10-23', '2025-12-05', '2025-12-10', '2025-12-31',
            // 2026
            '2026-01-01', '2026-01-02', '2026-03-03', '2026-04-06', '2026-04-13',
            '2026-04-14', '2026-04-15', '2026-05-04', '2026-05-13', '2026-05-31',
            '2026-06-01', '2026-06-03', '2026-07-28', '2026-07-29', '2026-07-30',
            '2026-08-12', '2026-10-13', '2026-10-23', '2026-12-05', '2026-12-07',
            '2026-12-10', '2026-12-31'
        ];

        // ==================== STATE ====================
        let allRecords = [];
        let allDailyOps = []; // New state for Daily Operations
        let filteredRecords = [];
        let recordToDelete = null;
        let isEditing = false;
        let isDailyEditing = false; // New state for Daily Edit
        let selectedFile = null;
        let currentAttachment = null;
        let currentView = 'dashboard';

        // Pagination state
        let currentPage = 1;
        let pageSize = 10;

        // ==================== NAVIGATION & VIEW LOGIC ====================

        function switchView(viewName) {
            // Hide all views
            ['dashboard', 'daily-ops', 'registry', 'calendar'].forEach(v => {
                document.getElementById(`view-${v}`).classList.add('hidden');
                document.getElementById(`nav-${v}`).classList.replace('text-blue-600', 'text-gray-500');
                document.getElementById(`nav-${v}`).classList.replace('border-blue-600', 'border-transparent');
            });

            // Show selected view
            document.getElementById(`view-${viewName}`).classList.remove('hidden');
            const navBtn = document.getElementById(`nav-${viewName}`);
            navBtn.classList.replace('text-gray-500', 'text-blue-600');
            navBtn.classList.replace('border-transparent', 'border-blue-600');

            currentView = viewName;

            // Load data if needed
            if (viewName === 'dashboard') {
                renderDashboard();
            } else if (viewName === 'daily-ops' && allDailyOps.length === 0) {
                fetchDailyOps();
            } else if (viewName === 'registry' && allRecords.length === 0) {
                fetchAllRecords();
            } else if (viewName === 'calendar') {
                // Ensure both data sources are loaded for calendar
                Promise.all([
                    allRecords.length === 0 ? fetchAllRecords(false) : Promise.resolve(),
                    allDailyOps.length === 0 ? fetchDailyOps(false) : Promise.resolve()
                ]).then(() => {
                    renderCalendar();
                });
            }
        }

        // ==================== CALENDAR LOGIC ====================
        let currentCalendarDate = new Date();

        function renderCalendar() {
            const date = currentCalendarDate;
            const year = date.getFullYear();
            const month = date.getMonth();

            // Update Header
            const thaiMonths = ["‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°", "‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå", "‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°", "‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô", "‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°", "‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô", "‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°", "‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°", "‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô", "‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°", "‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô", "‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°"];
            document.getElementById('calendar-month-year').textContent = `${thaiMonths[month]} ${year + 543}`;

            const grid = document.getElementById('calendar-grid');
            grid.innerHTML = '';

            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);

            // Days from previous month to fill start
            const startingDay = firstDay.getDay(); // 0 = Sunday
            const prevMonthLastDay = new Date(year, month, 0).getDate();

            // Previous month days
            for (let i = startingDay - 1; i >= 0; i--) {
                const dayDiv = document.createElement('div');
                dayDiv.className = 'bg-white min-h-[100px] p-2 text-gray-400 text-sm opacity-50';
                dayDiv.textContent = prevMonthLastDay - i;
                grid.appendChild(dayDiv);
            }

            // Current month days
            const events = mapDataToEvents(year, month);

            for (let i = 1; i <= lastDay.getDate(); i++) {
                const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(i).padStart(2, '0')}`;
                const dayEvents = events[dateStr] || [];
                const isToday = isDateToday(dateStr);
                const isHoliday = PUBLIC_HOLIDAYS.includes(dateStr);

                const dayDiv = document.createElement('div');

                // Styling: Highlighting holidays
                let borderClass = 'border-transparent';
                if (isToday) borderClass = 'border-blue-500';
                else if (isHoliday) borderClass = 'border-red-200 bg-red-50/30';

                dayDiv.className = `bg-white min-h-[100px] p-2 hover:bg-gray-50 transition-colors cursor-pointer border-t-2 ${borderClass}`;
                dayDiv.onclick = () => openCalendarModal(dateStr, dayEvents);

                // Date Number Style
                let dateNumberClass = 'text-gray-700';
                if (isToday) dateNumberClass = 'text-blue-600 bg-blue-100 rounded-full w-6 h-6 flex items-center justify-center';
                else if (isHoliday) dateNumberClass = 'text-red-600 font-bold';

                let html = `
                    <div class="flex justify-between items-start mb-1">
                        <span class="font-bold text-sm ${dateNumberClass}">
                            ${i} 
                            ${isHoliday && !isToday ? '<span class="text-[10px] font-normal ml-1 bg-red-100 text-red-600 px-1 rounded">‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î</span>' : ''}
                        </span>
                        ${dayEvents.length > 0 ? `<span class="text-xs text-gray-400 font-medium">${dayEvents.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span>` : ''}
                    </div>
                    <div class="space-y-1">
                `;

                // Show max 3 events preview
                dayEvents.slice(0, 3).forEach(event => {
                    html += `
                        <div class="text-[10px] truncate px-1.5 py-0.5 rounded ${event.bgColor} ${event.textColor}">
                            ${event.title}
                        </div>
                    `;
                });

                if (dayEvents.length > 3) {
                    html += `<div class="text-[10px] text-gray-500 pl-1">+ ‡∏≠‡∏µ‡∏Å ${dayEvents.length - 3} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>`;
                }

                html += `</div>`;
                dayDiv.innerHTML = html;
                grid.appendChild(dayDiv);
            }

            // Next month days to fill grid (assuming 6 rows max = 42 cells)
            const totalCells = startingDay + lastDay.getDate();
            const remainingCells = 42 - totalCells;

            for (let i = 1; i <= remainingCells; i++) {
                const dayDiv = document.createElement('div');
                dayDiv.className = 'bg-white min-h-[100px] p-2 text-gray-400 text-sm opacity-50';
                dayDiv.textContent = i;
                grid.appendChild(dayDiv);
            }
        }

        function mapDataToEvents(year, month) {
            const events = {};

            // 1. Map Registry Data
            allRecords.forEach(record => {
                // Receive from Coop (Blue)
                if (record.receive_from_coop_date) addEvent(events, record.receive_from_coop_date, `‡∏£‡∏±‡∏ö: ${record.cooperative_name}`, 'bg-blue-100', 'text-blue-700', record);
                // Send back to Coop (Green)
                if (record.send_back_to_coop_date) addEvent(events, record.send_back_to_coop_date, `‡∏™‡∏ô‡∏á.‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏£‡πá‡∏à: ${record.cooperative_name}`, 'bg-green-100', 'text-green-700', record);
                // Receive from Admin (Orange)
                if (record.receive_from_admin_date) addEvent(events, record.receive_from_admin_date, `‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£: ${record.cooperative_name}`, 'bg-orange-100', 'text-orange-700', record);
                // Group Complete (Purple)
                if (record.group_complete_date) addEvent(events, record.group_complete_date, `‡∏Å‡∏•‡∏∏‡πà‡∏°.‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏£‡πá‡∏à: ${record.cooperative_name}`, 'bg-purple-100', 'text-purple-700', record);
            });

            // 2. Map Daily Ops Data
            allDailyOps.forEach(op => {
                if (op.date) {
                    addEvent(events, op.date, `‡∏á‡∏≤‡∏ô: ${op.activity}`, 'bg-gray-100', 'text-gray-700', op, true);
                }
            });

            return events;
        }

        function addEvent(eventsMap, dateStr, title, bgColor, textColor, data, isDailyOp = false) {
            // Ensure dateStr is valid YYYY-MM-DD
            if (!dateStr || typeof dateStr !== 'string') return;
            const cleanDate = dateStr.split('T')[0];

            if (!eventsMap[cleanDate]) {
                eventsMap[cleanDate] = [];
            }
            eventsMap[cleanDate].push({
                title,
                bgColor,
                textColor,
                data,
                isDailyOp
            });
        }

        function isDateToday(dateStr) {
            const today = new Date().toISOString().split('T')[0];
            return dateStr === today;
        }

        function changeMonth(delta) {
            currentCalendarDate.setMonth(currentCalendarDate.getMonth() + delta);
            renderCalendar();
        }

        function goToToday() {
            currentCalendarDate = new Date();
            renderCalendar();
        }

        function openCalendarModal(dateStr, events) {
            const date = new Date(dateStr);
            const thaiDate = date.toLocaleDateString('th-TH', { day: 'numeric', month: 'long', year: 'numeric' });
            document.getElementById('calendar-modal-date').textContent = thaiDate;

            const content = document.getElementById('calendar-modal-content');

            let html = '';

            if (events && events.length > 0) {
                html = events.map(event => `
                    <div class="p-3 rounded-lg border border-gray-100 hover:shadow-sm transition-shadow ${event.bgColor.replace('100', '50')}">
                        <div class="flex items-center gap-2 mb-1">
                            <span class="w-2 h-2 rounded-full ${event.bgColor.replace('bg-', 'bg-').replace('100', '500')}"></span>
                            <h4 class="font-bold text-gray-800 text-sm">${event.title}</h4>
                        </div>
                        ${event.isDailyOp ?
                        `<p class="text-xs text-gray-600 ml-4">${event.data.time ? formatTime(event.data.time) + ' ‡∏ô. ' : ''}${event.data.location || ''}</p>
                             ${event.data.activity_details ? `<p class="text-xs text-gray-500 ml-4 mt-1 line-clamp-2">${event.data.activity_details}</p>` : ''}`
                        :
                        `<p class="text-xs text-gray-600 ml-4">${event.data.document_type || ''} - ${event.data.document_topic || ''}</p>
                             <p class="text-xs text-gray-500 ml-4">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ${event.data.status}</p>`
                    }
                    </div>
                `).join('');
            } else {
                html = `<div class="text-center text-gray-400 py-4 text-sm">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>`;
            }

            // Add Buttons
            html += `
                <div class="mt-4 pt-4 border-t border-gray-100 flex flex-col gap-2">
                    <button onclick="closeCalendarModal(); switchView('daily-ops'); openDailyOpModal('${dateStr}')" 
                        class="w-full py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center gap-2 text-sm font-medium">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
                        ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô
                    </button>
                    <button onclick="closeCalendarModal(); switchView('registry'); openNewRegistryModal('${dateStr}')" 
                        class="w-full py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors flex items-center justify-center gap-2 text-sm font-medium">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                        ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏∏‡∏°
                    </button>
                </div>
            `;

            content.innerHTML = html;
            document.getElementById('calendar-modal').classList.remove('hidden');
        }

        function closeCalendarModal() {
            document.getElementById('calendar-modal').classList.add('hidden');
        }

        // ==================== DAILY OPS LOGIC ====================

        async function fetchDailyOps() {
            try {
                showLoading(true);
                const response = await fetch(`${SCRIPT_URL}?action=getDailyOps`, { redirect: 'follow' });
                const result = await response.json();

                if (result.success) {
                    allDailyOps = result.data;
                    renderDailyOpsTable();
                    renderDashboard(); // Refresh dashboard if data changed
                } else {
                    showToast('‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'error');
                }
            } catch (error) {
                console.error('Error fetching daily ops:', error);
                showToast('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå', 'error');
            } finally {
                showLoading(false);
            }
        }

        function renderDailyOpsTable() {
            const tbody = document.getElementById('daily-ops-table-body');
            const filterDate = document.getElementById('daily-filter-date').value;

            let displayData = allDailyOps;
            if (filterDate) {
                displayData = allDailyOps.filter(op => op.date === filterDate);
            }

            // Sort by Date DESC, Time DESC
            displayData.sort((a, b) => {
                if (a.date !== b.date) return new Date(b.date) - new Date(a.date);
                return b.time.localeCompare(a.time);
            });

            if (displayData.length === 0) {
                tbody.innerHTML = `<tr><td colspan="5" class="p-4 text-center text-gray-500">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>`;
                return;
            }

            tbody.innerHTML = displayData.map(op => `
                <tr class="hover:bg-gray-50">
                    <td class="px-4 py-3 text-sm text-gray-800">
                        <div class="font-medium">${formatDate(op.date)}</div>
                        <div class="text-xs text-gray-500">${formatTime(op.time)}</div>
                    </td>
                    <td class="px-4 py-3 text-sm text-gray-800">${op.activity}</td>
                    <td class="px-4 py-3 text-sm text-gray-600">${op.location}</td>
                    <td class="px-4 py-3 text-sm">
                        <span class="px-2 py-1 rounded text-xs font-medium ${getStatusColor(op.status)}">
                            ${op.status}
                        </span>
                    </td>
                    <td class="px-4 py-3 text-sm">
                        <button onclick='viewDailyOpDetails(${JSON.stringify(op).replace(/'/g, "&#39;")})' class="text-gray-500 hover:text-blue-600 hover:underline mr-2" title="‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î">
                            <svg class="w-5 h-5 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg>
                        </button>
                        <button onclick='editDailyOp(${JSON.stringify(op).replace(/'/g, "&#39;")})' class="text-blue-600 hover:underline mr-2">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                        <button onclick="deleteDailyOp('${op.id}')" class="text-red-600 hover:underline">‡∏•‡∏ö</button>
                    </td>
                </tr>
            `).join('');
        }

        function getStatusColor(status) {
            switch (status) {
                case '‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß': return 'bg-green-100 text-green-700';
                case '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£': return 'bg-blue-100 text-blue-700';
                default: return 'bg-yellow-100 text-yellow-700';
            }
        }

        function openDailyOpModal(dateStr = null) {
            isDailyEditing = false;
            document.getElementById('daily-modal-title').textContent = '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà';
            document.getElementById('form-daily-op').reset();
            document.getElementById('daily-id').value = '';

            // Set default date/time
            const now = new Date();
            // Use provided dateStr or Today
            document.getElementById('daily-date').value = dateStr || now.toISOString().split('T')[0];

            // Format HH:mm
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            document.getElementById('daily-time').value = `${hours}:${minutes}`;
            document.getElementById('daily-details').value = '';

            document.getElementById('daily-ops-modal').classList.remove('hidden');
        }

        function closeDailyOpModal() {
            document.getElementById('daily-ops-modal').classList.add('hidden');
        }

        function viewDailyOpDetails(op) {
            document.getElementById('view-activity').textContent = op.activity || '-';
            document.getElementById('view-details').textContent = op.activity_details || '-';
            document.getElementById('view-datetime').textContent = `${formatDate(op.date)} ‡πÄ‡∏ß‡∏•‡∏≤ ${formatTime(op.time)} ‡∏ô.`;
            document.getElementById('view-location').textContent = op.location || '-';

            const statusSpan = document.getElementById('view-status');
            statusSpan.className = `inline-block px-2 py-1 rounded text-xs font-medium ${getStatusColor(op.status)}`;
            statusSpan.textContent = op.status;

            document.getElementById('view-details-modal').classList.remove('hidden');
        }

        function closeViewDetailsModal() {
            document.getElementById('view-details-modal').classList.add('hidden');
        }

        function editDailyOp(op) {
            isDailyEditing = true;
            document.getElementById('daily-modal-title').textContent = '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏á‡∏≤‡∏ô';
            document.getElementById('daily-id').value = op.id;
            document.getElementById('daily-date').value = op.date;
            document.getElementById('daily-time').value = op.time;
            document.getElementById('daily-activity').value = op.activity;
            document.getElementById('daily-details').value = op.activity_details || '';
            document.getElementById('daily-location').value = op.location;
            document.getElementById('daily-status').value = op.status;
            document.getElementById('daily-notes').value = op.notes || '';
            document.getElementById('daily-ops-modal').classList.remove('hidden');
        }

        async function handleDailyOpSubmit(e) {
            e.preventDefault();
            const btn = document.getElementById('btn-save-daily');
            btn.disabled = true;
            btn.textContent = '‡∏Å‡∏≥‡∏•‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...';

            const record = {
                id: document.getElementById('daily-id').value,
                date: document.getElementById('daily-date').value,
                time: document.getElementById('daily-time').value,
                activity: document.getElementById('daily-activity').value,
                activity_details: document.getElementById('daily-details').value,
                location: document.getElementById('daily-location').value,
                status: document.getElementById('daily-status').value,
                notes: document.getElementById('daily-notes').value
            };

            const action = isDailyEditing ? 'updateDailyOp' : 'createDailyOp';

            try {
                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    redirect: 'follow',
                    body: JSON.stringify({ action, record })
                });
                const result = await response.json();

                if (result.success) {
                    showToast('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                    closeDailyOpModal();
                    fetchDailyOps();
                } else {
                    showToast('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ' + result.error, 'error');
                }
            } catch (error) {
                console.error(error);
                showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', 'error');
            } finally {
                btn.disabled = false;
                btn.textContent = '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å';
            }
        }

        async function deleteDailyOp(id) {
            if (!confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•?')) return;

            try {
                showLoading(true);
                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    redirect: 'follow',
                    body: JSON.stringify({ action: 'deleteDailyOp', id })
                });
                const result = await response.json();
                if (result.success) {
                    showToast('‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                    fetchDailyOps();
                } else {
                    showToast('‡∏•‡∏ö‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ' + result.error, 'error');
                }
            } catch (error) {
                showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', 'error');
            } finally {
                showLoading(false);
            }
        }

        function formatTime(timeStr) {
            if (!timeStr) return '-';
            // Check if it's an ISO string (contains T)
            if (typeof timeStr === 'string' && timeStr.includes('T')) {
                try {
                    const date = new Date(timeStr);
                    return date.toLocaleTimeString('th-TH', { hour: '2-digit', minute: '2-digit', hour12: false });
                } catch (e) {
                    return timeStr.substring(0, 5);
                }
            }
            // Fallback for simple time strings "HH:mm"
            return String(timeStr).substring(0, 5);
        }

        // ==================== DASHBOARD LOGIC ====================

        function renderDashboard() {
            // --- 1. Upcoming Alerts Logic (Next 7 Days) ---
            const now = new Date(); // Current specific time
            const today = new Date(now);
            today.setHours(0, 0, 0, 0); // Midnight today

            const nextWeek = new Date(today);
            nextWeek.setDate(today.getDate() + 7);

            const upcomingOps = allDailyOps.filter(op => {
                if (!op.date) return false;
                // Parse date purely as YYYY-MM-DD local
                const parts = op.date.split('-');
                let year = parseInt(parts[0], 10);
                const month = parseInt(parts[1], 10) - 1;
                const day = parseInt(parts[2], 10);

                // If year is in Buddhist Era (> 2100), convert to CE
                if (year > 2100) {
                    year = year - 543;
                }

                const opDate = new Date(year, month, day); // Local midnight of the op

                // 1. Skip past dates entirely
                if (opDate < today) return false;

                // 2. Skip future dates beyond next week
                if (opDate > nextWeek) return false;

                // 3. For Today's events, check time
                if (opDate.toDateString() === today.toDateString()) {
                    // If no time recorded, hide it (assume it already happened)
                    if (!op.time) return false;

                    // Parse time - handle ISO datetime or simple "HH:MM" format
                    let h = 0, m = 0;
                    const timeStr = String(op.time);

                    if (timeStr.includes('T')) {
                        // ISO datetime format (e.g., 1899-12-30T10:30:00.000Z)
                        const tempDate = new Date(timeStr);
                        h = tempDate.getHours();
                        m = tempDate.getMinutes();
                    } else {
                        // Simple "HH:MM" or "HH:MM:SS" format
                        const timeParts = timeStr.split(':');
                        h = parseInt(timeParts[0], 10) || 0;
                        m = parseInt(timeParts[1], 10) || 0;
                    }

                    // Create datetime for the scheduled activity
                    const opActiveTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), h, m, 0, 0);

                    // If the scheduled time has passed, don't show
                    if (opActiveTime <= now) return false;
                }

                return true;
            }).sort((a, b) => new Date(a.date) - new Date(b.date));

            const alertContainer = document.getElementById('dashboard-alerts');
            if (upcomingOps.length > 0) {
                alertContainer.innerHTML = `
                    <div class="bg-orange-50 border-l-4 border-orange-500 p-4 rounded-r-lg shadow-sm">
                        <div class="flex items-start">
                            <div class="flex-shrink-0">
                                <svg class="h-5 w-5 text-orange-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                    <path d="M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z" />
                                </svg>
                            </div>
                            <div class="ml-3 w-full">
                                <h3 class="text-sm font-medium text-orange-800">
                                    ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏∞‡∏°‡∏≤‡∏ñ‡∏∂‡∏á (7 ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤)
                                </h3>
                                <div class="mt-2 text-sm text-orange-700 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2">
                                    ${upcomingOps.map(op => {
                    // Parse date purely as YYYY-MM-DD local
                    const parts = op.date.split('-');
                    const opDate = new Date(parts[0], parts[1] - 1, parts[2]); // Local midnight

                    const diffTime = opDate - today;
                    const diffDays = Math.round(diffTime / (1000 * 60 * 60 * 24)); // Use round instead of ceil for clean midnight diffs

                    let dayText = '';
                    if (diffDays === 0) dayText = '‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ';
                    else if (diffDays === 1) dayText = '‡∏û‡∏£‡∏∏‡πà‡∏á‡∏ô‡∏µ‡πâ';
                    else dayText = `‡∏≠‡∏µ‡∏Å ${diffDays} ‡∏ß‡∏±‡∏ô`;

                    return `
                                        <div class="bg-white/60 p-2 rounded border border-orange-100 flex items-center justify-between cursor-pointer hover:bg-white transition-colors" onclick='switchView("daily-ops");'>
                                            <div class="truncate pr-2">
                                                <span class="font-bold mr-1">[${dayText}]</span>
                                                ${op.activity}
                                            </div>
                                            <span class="text-xs bg-orange-200 text-orange-800 px-1.5 py-0.5 rounded ml-2 whitespace-nowrap">
                                                ${formatDateShort(op.date).day} ${formatDateShort(op.date).month}
                                            </span>
                                        </div>`;
                }).join('')}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                alertContainer.classList.remove('hidden');
            } else {
                alertContainer.classList.add('hidden');
            }

            // --- 2. Recent Ops with Time Filter ---
            const timeFilter = document.getElementById('dashboard-time-filter')?.value || 'month';

            // Calculate filter date ranges
            const filterStartDate = new Date(today);
            const filterEndDate = new Date(today);
            filterEndDate.setHours(23, 59, 59, 999);

            switch (timeFilter) {
                case 'week':
                    // Start from Sunday of this week
                    const dayOfWeek = today.getDay();
                    filterStartDate.setDate(today.getDate() - dayOfWeek);
                    filterStartDate.setHours(0, 0, 0, 0);
                    // End at Saturday
                    filterEndDate.setDate(filterStartDate.getDate() + 6);
                    break;
                case 'month':
                    // Start from 1st of this month
                    filterStartDate.setDate(1);
                    filterStartDate.setHours(0, 0, 0, 0);
                    // End at last day of month
                    filterEndDate.setMonth(filterEndDate.getMonth() + 1, 0);
                    break;
                case 'year':
                    // Start from Jan 1 of this year
                    filterStartDate.setMonth(0, 1);
                    filterStartDate.setHours(0, 0, 0, 0);
                    // End at Dec 31
                    filterEndDate.setMonth(11, 31);
                    break;
                case 'all':
                default:
                    // No filter - show all
                    filterStartDate.setFullYear(1900);
                    filterEndDate.setFullYear(9999);
                    break;
            }

            // Filter and sort ops
            const filteredOps = allDailyOps.filter(op => {
                if (!op.date) return false;

                // Parse date as YYYY-MM-DD local
                const parts = op.date.split('-');
                let year = parseInt(parts[0], 10);
                const month = parseInt(parts[1], 10) - 1;
                const day = parseInt(parts[2], 10);

                // Convert Buddhist Era to CE if needed
                if (year > 2100) {
                    year = year - 543;
                }

                const opDate = new Date(year, month, day);
                return opDate >= filterStartDate && opDate <= filterEndDate;
            });

            // Sort by Date DESC, Time DESC
            const sortedOps = filteredOps.sort((a, b) => {
                if (a.date !== b.date) return new Date(b.date) - new Date(a.date);
                return (b.time || '').localeCompare(a.time || '');
            }).slice(0, 10); // Take top 10 for filtered view

            const dailyContainer = document.getElementById('dashboard-daily-content');

            // Generate filter period text
            let filterPeriodText = '';
            switch (timeFilter) {
                case 'week': filterPeriodText = '‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ô‡∏µ‡πâ'; break;
                case 'month': filterPeriodText = '‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ'; break;
                case 'year': filterPeriodText = '‡∏õ‡∏µ‡∏ô‡∏µ‡πâ'; break;
                default: filterPeriodText = '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î'; break;
            }

            if (sortedOps.length === 0) {
                dailyContainer.innerHTML = `
                    <div class="flex flex-col items-center justify-center py-12 text-gray-300">
                        <svg class="w-16 h-16 mb-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
                        <p class="text-lg font-medium text-gray-500">${timeFilter === 'all' ? '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô' : `‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô${filterPeriodText}`}</p>
                        <p class="text-sm text-gray-400">${timeFilter === 'all' ? '‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏á‡∏≤‡∏ô‡πÇ‡∏î‡∏¢‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà"' : '‡∏•‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏∑‡πà‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà'}</p>
                    </div>
                `;
            } else {
                // Summary info
                const summaryInfo = filteredOps.length > 10
                    ? `<div class="text-xs text-gray-500 mb-3 flex items-center justify-between px-2">
                        <span>‡πÅ‡∏™‡∏î‡∏á 10 ‡∏à‡∏≤‡∏Å ${filteredOps.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£${timeFilter !== 'all' ? ` (${filterPeriodText})` : ''}</span>
                       </div>`
                    : (timeFilter !== 'all' ? `<div class="text-xs text-gray-500 mb-3 px-2">${filteredOps.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô${filterPeriodText}</div>` : '');

                dailyContainer.innerHTML = `
                    ${summaryInfo}
                    <div class="space-y-3">
                        ${sortedOps.map(op => `
                            <div class="group flex items-start gap-4 p-4 bg-gray-50 hover:bg-white rounded-xl border border-gray-100 hover:shadow-md transition-all duration-200 cursor-pointer" onclick='viewDailyOpDetails(${JSON.stringify(op).replace(/'/g, "&#39;")})'>
                                <div class="flex flex-col items-center min-w-[60px]">
                                    <div class="text-[10px] font-bold text-gray-400 uppercase tracking-wider">${formatDate(op.date).split('/')[1] || '-'}</div>
                                    <div class="text-xl font-bold text-gray-800">${formatDateShort(op.date).day}</div>
                                </div>
                                <div class="w-px h-10 bg-gray-200 self-center"></div>
                                <div class="flex-1 min-w-0">
                                    <div class="flex justify-between items-start">
                                        <h4 class="font-bold text-gray-800 truncate pr-2">${op.activity}</h4>
                                        <div class="flex items-center gap-2">
                                            <span class="text-xs font-medium px-2 py-0.5 rounded-full whitespace-nowrap ${getStatusColor(op.status)}">${op.status}</span>
                                            <button class="text-gray-400 hover:text-blue-600 transition-colors" title="‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="flex items-center gap-3 mt-1 text-sm text-gray-500">
                                        <div class="flex items-center gap-1">
                                            <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                            ${formatTime(op.time)} ‡∏ô.
                                        </div>
                                        <div class="flex items-center gap-1 truncate">
                                            <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                                            ${op.location}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }

            // Registry Stats
            const total = allRecords.length;
            const pending = allRecords.filter(r => r.status === '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£').length;
            const process = allRecords.filter(r => r.status === '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£').length;
            const done = allRecords.filter(r => r.status === '‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß').length;

            // Calculate success percentage
            const successPercent = total > 0 ? Math.round((done / total) * 100) : 0;
            const progressBar = document.getElementById('progress-bar-success');
            const progressText = document.getElementById('progress-text-success');
            if (progressBar) progressBar.style.width = `${successPercent}%`;
            if (progressText) progressText.innerText = `${successPercent}%`;

            document.getElementById('dashboard-registry-stats').innerHTML = `
                <div class="col-span-2 bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl p-5 text-white shadow-lg shadow-blue-200 relative overflow-hidden group">
                    <div class="absolute right-0 top-0 w-24 h-24 bg-white opacity-10 rounded-full -mr-6 -mt-6 group-hover:scale-110 transition-transform duration-500"></div>
                    <div class="relative z-10">
                        <div class="text-blue-100 text-sm font-medium mb-1">‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                        <div class="text-4xl font-bold tracking-tight">${total}</div>
                        <div class="mt-2 text-xs text-blue-100 opacity-80">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>
                    </div>
                </div>

                <div class="bg-white rounded-2xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow">
                    <div class="w-8 h-8 rounded-lg bg-yellow-100 text-yellow-600 flex items-center justify-center mb-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    </div>
                    <div class="text-2xl font-bold text-gray-800">${pending}</div>
                    <div class="text-xs text-gray-500">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
                </div>

                <div class="bg-white rounded-2xl p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow">
                    <div class="w-8 h-8 rounded-lg bg-indigo-100 text-indigo-600 flex items-center justify-center mb-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>
                    </div>
                    <div class="text-2xl font-bold text-gray-800">${process}</div>
                    <div class="text-xs text-gray-500">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥</div>
                </div>

                <div class="col-span-2 bg-green-50 rounded-2xl p-4 border border-green-100 flex items-center justify-between">
                    <div>
                        <div class="text-green-800 font-bold text-xl">${done}</div>
                        <div class="text-green-600 text-xs text-nowrap">‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô</div>
                    </div>
                    <div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center text-green-600">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                    </div>
                </div>
            `;
        }

        // Helper to format date for dashboard calendar icon
        function formatDateShort(dateStr) {
            if (!dateStr) return { day: '-', month: '-' };
            const date = new Date(dateStr);
            const day = date.getDate();
            // Thai months abbr
            const months = ["‡∏°.‡∏Ñ.", "‡∏Å.‡∏û.", "‡∏°‡∏µ.‡∏Ñ.", "‡πÄ‡∏°.‡∏¢.", "‡∏û.‡∏Ñ.", "‡∏°‡∏¥.‡∏¢.", "‡∏Å.‡∏Ñ.", "‡∏™.‡∏Ñ.", "‡∏Å.‡∏¢.", "‡∏ï.‡∏Ñ.", "‡∏û.‡∏¢.", "‡∏ò.‡∏Ñ."];
            const month = months[date.getMonth()];
            return { day, month };
        } const COOP_NAMES = [
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡∏™‡∏ß‡∏ô‡∏¢‡∏≤‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡∏™‡∏´‡∏°‡∏¥‡∏ï‡∏£ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏®‡∏£‡∏µ‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏¢‡∏π‡πÄ‡∏ô‡∏µ‡πà‡∏¢‡∏ô ‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏°‡∏≤‡∏ö‡∏ï‡∏≤‡∏û‡∏∏‡∏î‡∏£‡πà‡∏ß‡∏°‡πÉ‡∏à ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÑ‡∏≠‡∏≠‡∏≤‡∏£‡πå‡∏û‡∏µ‡∏ã‡∏µ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏Ñ‡∏£‡∏π‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡∏†‡∏π‡∏ò‡∏£‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÇ‡∏Ñ‡πÄ‡∏ß‡∏™‡πÇ‡∏ï‡∏£‡∏°‡∏≤‡∏ö‡∏ï‡∏≤‡∏û‡∏∏‡∏î ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÑ‡∏≠‡∏≠‡∏≤‡∏£‡πå‡∏û‡∏µ‡∏ã‡∏µ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏™‡∏∏‡∏Ç‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡∏™‡∏ß‡∏ô‡∏¢‡∏≤‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ö‡πâ‡∏≤‡∏ô‡∏ó‡πà‡∏≤‡πÄ‡∏™‡∏≤ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏ö‡πâ‡∏≤‡∏ô‡∏â‡∏≤‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏ú‡∏π‡πâ‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏î‡∏¥‡∏ô‡∏£‡∏ñ‡∏£‡∏∞‡∏¢‡∏≠‡∏á‡∏™‡∏≤‡∏°‡∏±‡∏Ñ‡∏Ñ‡∏µ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏£‡∏ñ‡∏£‡∏ß‡∏°‡πÉ‡∏à ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡∏ï‡∏≥‡∏ö‡∏•‡∏ö‡πâ‡∏≤‡∏ô‡∏â‡∏≤‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏¢‡∏≠‡∏á‡∏¢‡∏±‡πà‡∏á‡∏¢‡∏∑‡∏ô ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå ‡∏≠‡∏π‡πÄ‡∏ö‡∏∞ (‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢) ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏£‡πà‡∏ß‡∏°‡πÄ‡∏à‡∏£‡∏¥‡∏ç ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡πÑ‡∏≠‡∏≠‡∏≤‡∏£‡πå‡∏û‡∏µ‡∏ã‡∏µ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡∏™‡∏ß‡∏ô‡∏¢‡∏≤‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏ô‡∏¥‡∏ô‡∏™‡∏ß‡πà‡∏≤‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏¢‡∏π‡πÄ‡∏ô‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏Å‡∏≤‡∏∞‡∏Å‡∏Å‡∏´‡∏ô‡∏≠‡∏á‡πÅ‡∏ï‡∏á‡πÄ‡∏°‡∏£‡πà‡∏ß‡∏°‡πÉ‡∏à ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏£‡∏ñ‡∏ö‡πâ‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡∏¢‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏≠‡∏¥‡∏ô‡πÇ‡∏î‡∏£‡∏≤‡∏°‡∏≤ (2019) ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡πÑ‡∏ó‡∏¢‡πÇ‡∏û‡∏•‡∏µ‡∏≠‡∏∞‡∏ã‡∏µ‡∏ó‡∏±‡∏•‡πÅ‡∏•‡∏∞‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡πÑ‡∏ó‡∏¢‡πÇ‡∏û‡∏•‡∏µ‡∏Ñ‡∏≤‡∏£‡πå‡∏ö‡∏≠‡πÄ‡∏ô‡∏ï ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏≠‡∏¥‡∏ô‡πÇ‡∏î‡∏£‡∏≤‡∏°‡∏≤ ‡∏õ‡∏¥‡πÇ‡∏ï‡∏£‡πÄ‡∏Ñ‡∏° ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡πÄ‡∏≠‡πá‡∏ô‡∏û‡∏µ‡∏ã‡∏µ‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏£‡∏ñ‡∏ï‡∏≤‡∏Ç‡∏±‡∏ô ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Å‡∏≠‡∏á‡∏ö‡∏¥‡∏ô‡∏ó‡∏´‡∏≤‡∏£‡πÄ‡∏£‡∏∑‡∏≠ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏¢‡∏π‡πÄ‡∏ô‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡πÅ‡∏´‡∏•‡∏°‡∏£‡∏∏‡πà‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏á‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏¢‡∏π‡πÄ‡∏ô‡∏µ‡πà‡∏¢‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡πÑ‡∏£‡πà‡∏à‡∏±‡∏ô‡∏î‡∏µ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏î‡∏¥‡∏ô‡∏£‡∏ñ‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏£‡∏ñ‡∏õ‡∏≤‡∏Å‡∏ô‡πâ‡∏≥‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏£‡∏ñ‡∏£‡∏∞‡∏¢‡∏≠‡∏á‡∏£‡∏ß‡∏°‡∏£‡∏ñ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏õ‡∏£‡∏∞‡∏°‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏û ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏õ‡∏£‡∏∞‡∏°‡∏á‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡∏™‡∏ß‡∏ô‡∏¢‡∏≤‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡∏ä‡∏∏‡∏°‡∏ô‡∏∏‡∏°‡∏™‡∏π‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡πÄ‡∏Ç‡∏≤‡∏ä‡∏∞‡πÄ‡∏°‡∏≤ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÅ‡∏Å‡∏•‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏ö‡πâ‡∏≤‡∏ô‡∏ô‡πâ‡∏≥‡πÄ‡∏õ‡πá‡∏ô ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡∏™‡∏ß‡∏ô‡∏¢‡∏≤‡∏á‡∏ï‡∏≥‡∏ö‡∏•‡∏ä‡∏≥‡∏Ü‡πâ‡∏≠ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏ó‡∏∏‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏¢‡∏Å‡∏¥‡∏ô ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏ö‡πâ‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡∏¢ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏¢‡∏π‡πÄ‡∏ô‡∏µ‡πà‡∏¢‡∏ô‡∏≠‡∏≤‡πÇ‡∏≠‡∏¢‡∏≤‡∏°‡πà‡∏≤‡πÑ‡∏ó‡∏¢ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏¢‡∏π‡πÄ‡∏ô‡∏µ‡πà‡∏¢‡∏ô ‡πÄ‡∏≠‡πÄ‡∏≠‡∏ó‡∏µ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏¢‡∏π‡πÄ‡∏ô‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏•‡∏∞‡∏´‡∏≤‡∏£ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏¢‡∏π‡πÄ‡∏ô‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏≠‡∏ü ‡∏ó‡∏µ ‡πÄ‡∏≠‡πá‡∏° ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏î‡∏≠‡∏Å‡∏Å‡∏£‡∏≤‡∏¢ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏ó‡∏™‡∏∏‡∏°‡∏¥‡πÄ‡∏ó‡πá‡∏Ñ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏≠‡πÄ‡∏î‡∏µ‡∏¢‡∏ô‡∏ó‡πå ‡πÅ‡∏≠‡∏ô‡∏î‡πå ‡∏ã‡∏±‡∏°‡∏°‡∏¥‡∏ó ‡∏Ñ‡∏≠‡∏£‡πå‡∏õ‡∏≠‡πÄ‡∏£‡∏ä‡∏±‡πà‡∏ô ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏ä‡∏∏‡∏°‡∏ô‡∏∏‡∏°‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏õ‡∏•‡∏ß‡∏Å‡πÅ‡∏î‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏°‡∏ñ‡∏∏‡∏á‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å‡πÑ‡∏ó‡∏¢ ‡πÅ‡∏•‡∏∞‡πÄ‡∏≠‡πÄ‡∏õ‡∏Ñ‡∏ü‡∏¥‡∏•‡πå‡∏° ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏°‡∏¥‡∏ï‡∏ã‡∏∏‡∏¢ ‡πÑ‡∏Æ‡∏¢‡∏µ‡∏ô ‡πÅ‡∏°‡∏ó‡∏ó‡∏µ‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡∏™‡πå (‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢) ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ú‡∏±‡∏á 2 ‡∏î‡∏≠‡∏Å‡∏Å‡∏£‡∏≤‡∏¢ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏î‡∏¥‡∏ô‡∏£‡∏ñ‡∏û‡∏ô‡∏≤‡∏ô‡∏¥‡∏Ñ‡∏° ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏´‡∏™‡∏ñ‡∏≤‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏Å‡πâ‡∏≤‡∏ß‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏ô‡∏¥‡∏Ñ‡∏°‡∏Ø ‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏°‡∏¥‡∏ï‡∏ã‡∏π‡∏ö‡∏¥‡∏ä‡∏¥ ‡∏≠‡∏¥‡πÄ‡∏•‡∏Ñ‡∏ó‡∏£‡∏¥‡∏Ñ‡πÑ‡∏ó‡∏¢ ‡∏≠‡∏≠‡πÇ‡∏ï‡πâ-‡∏û‡∏≤‡∏£‡πå‡∏ó ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏´‡∏†‡∏≤‡∏û‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏°‡∏ó‡πà‡∏≠‡πÄ‡∏´‡∏•‡πá‡∏Å ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡πÇ‡∏ï‡πÑ‡∏Å ‡∏≠‡∏µ‡∏™‡πÄ‡∏ó‡∏¥‡∏£‡πå‡∏ô ‡∏£‡∏±‡∏ö‡πÄ‡∏ö‡∏≠‡∏£‡πå (‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢) ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏ã‡∏ô‡∏ï‡πå‡πÇ‡∏Å‡πÄ‡∏ö‡∏ô ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏°‡∏¥‡∏Å‡∏≤‡∏ã‡πà‡∏≤ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏¢‡∏π‡πÄ‡∏ô‡∏µ‡πà‡∏¢‡∏ô‡∏¢‡∏≤‡∏ô‡∏≤‡∏Å‡∏≤‡∏ß‡πà‡∏≤ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏¢‡∏π‡πÄ‡∏ô‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏¢‡∏≤‡∏°‡πÇ‡∏Å‡∏ä‡∏¥ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡∏™‡∏ß‡∏ô‡∏¢‡∏≤‡∏á‡∏õ‡∏•‡∏ß‡∏Å‡πÅ‡∏î‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡πÑ‡∏î‡∏Å‡∏¥‡πâ‡∏ô‡∏Ñ‡∏≠‡∏°‡πÄ‡∏û‡∏£‡∏™‡πÄ‡∏ã‡∏≠‡∏£‡πå ‡∏≠‡∏¥‡∏ô‡∏î‡∏±‡∏™‡∏ó‡∏£‡∏µ‡πâ‡∏™‡πå ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏ä‡∏π‡πÇ‡∏≠‡πÑ‡∏ó‡∏¢ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡πÑ‡∏ó‡∏¢‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå‡∏°‡∏¥‡∏•‡∏•‡πå ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Ñ‡∏≤‡∏ß‡∏≤‡∏ã‡∏≤‡∏Å‡∏¥ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏ã‡∏±‡∏á‡πÇ‡∏Å‡∏∞‡πÑ‡∏ó‡∏¢ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏¢‡∏π‡πÄ‡∏ô‡∏µ‡πà‡∏¢‡∏ô‡∏¢‡∏≤‡∏°‡∏≤‡∏î‡∏∞‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏¢‡∏π‡πÄ‡∏ô‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏´‡∏†‡∏≤‡∏û‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏ã‡∏π‡∏°‡∏¥‡πÇ‡∏ï‡πÇ‡∏°‡πà ‡∏£‡∏±‡∏ö‡πÄ‡∏ö‡∏≠‡∏£‡πå ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏´‡∏™‡∏ñ‡∏≤‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡∏™‡∏≤‡∏¢ 11 ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ô‡∏¥‡∏Ñ‡∏°‡∏ä‡∏∏‡∏°‡πÅ‡∏™‡∏á‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ô‡∏¥‡∏Ñ‡∏°‡∏ß‡∏±‡∏á‡πÑ‡∏ó‡∏£ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ô‡∏¥‡∏Ñ‡∏°‡πÄ‡∏Ç‡∏≤‡∏û‡∏ô‡∏°‡∏™‡∏≤‡∏£‡πå‡∏ó ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏ô‡∏¥‡∏Ñ‡∏°‡∏õ‡πà‡∏≤‡∏¢‡∏∏‡∏ö‡πÉ‡∏ô ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ ‡∏ò.‡∏Å.‡∏™.‡∏£‡∏∞‡∏¢‡∏≠‡∏á ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏™‡∏ß‡∏ô‡∏¢‡∏≤‡∏á‡∏û‡∏≤‡∏£‡∏≤‡∏ö‡∏≤‡∏á‡∏ö‡∏∏‡∏ï‡∏£',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏ô‡∏≤‡πÄ‡∏ä‡∏¥‡∏á‡πÄ‡∏ô‡∏¥‡∏ô',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏™‡∏ß‡∏ô‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏ó‡πâ‡∏≠‡∏ô',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏õ‡∏£‡∏∞‡∏°‡∏á‡∏õ‡∏≤‡∏Å‡∏ô‡πâ‡∏≥‡∏£‡∏∞‡∏¢‡∏≠‡∏á',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡πÑ‡∏£‡πà‡∏™‡∏±‡∏ö‡∏õ‡∏∞‡∏£‡∏î‡∏ï‡∏≥‡∏ö‡∏•‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏ó‡πâ‡∏≠‡∏ô',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏™‡∏ß‡∏ô‡∏ä‡∏≤‡∏Å‡∏ö‡∏Å',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏ô‡∏≤‡∏ó‡∏≤‡∏á‡πÄ‡∏Å‡∏ß‡∏µ‡∏¢‡∏ô',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏™‡∏ß‡∏ô‡πÄ‡∏Ç‡∏≤‡∏ô‡πâ‡∏≠‡∏¢',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏™‡∏ß‡∏ô‡∏ä‡∏∏‡∏°‡πÅ‡∏™‡∏á',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏™‡∏ß‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏ô‡∏≤',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏™‡∏ß‡∏ô‡∏ß‡∏±‡∏á‡∏´‡∏ß‡πâ‡∏≤',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏õ‡∏•‡∏π‡∏Å‡∏™‡∏±‡∏ö‡∏õ‡∏∞‡∏£‡∏î‡∏ó‡∏≤‡∏á‡πÄ‡∏Å‡∏ß‡∏µ‡∏¢‡∏ô',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡πÑ‡∏£‡πà‡∏™‡∏±‡∏ö‡∏õ‡∏∞‡∏£‡∏î‡∏ï‡∏≥‡∏ö‡∏•‡∏ä‡∏≥‡∏Ü‡πâ‡∏≠',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏™‡∏ß‡∏ô‡∏ô‡πâ‡∏≥‡πÄ‡∏õ‡πá‡∏ô',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏™‡∏ß‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏ä‡∏≤‡∏Å‡∏û‡∏á‡∏£‡∏ß‡∏°‡∏õ‡∏±‡∏ç‡∏ç‡∏≤',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏™‡∏ß‡∏ô‡∏õ‡πà‡∏≤‡∏¢‡∏∏‡∏ö‡πÉ‡∏ô',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏™‡∏ß‡∏ô‡∏ó‡∏∏‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏¢‡∏Å‡∏¥‡∏ô',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏™‡∏ß‡∏ô‡∏´‡πâ‡∏ß‡∏¢‡∏ó‡∏±‡∏ö‡∏°‡∏≠‡∏ç',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡πÑ‡∏£‡πà‡∏•‡∏∞‡∏´‡∏≤‡∏£',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡πÑ‡∏£‡πà‡∏™‡∏±‡∏ö‡∏õ‡∏∞‡∏£‡∏î‡∏û‡∏ô‡∏≤‡∏ô‡∏¥‡∏Ñ‡∏°',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡πÑ‡∏£‡πà‡∏™‡∏±‡∏ö‡∏õ‡∏∞‡∏£‡∏î‡∏ï‡∏≥‡∏ö‡∏•‡∏õ‡∏•‡∏ß‡∏Å‡πÅ‡∏î‡∏á',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏ô‡∏≤‡∏ö‡πâ‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡∏¢',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏ô‡∏≤‡∏ö‡∏≤‡∏á‡∏ö‡∏∏‡∏ï‡∏£',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡πÑ‡∏£‡πà‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≥‡∏Ñ‡∏π‡πâ',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡πÑ‡∏£‡πà‡∏™‡∏±‡∏ö‡∏õ‡∏∞‡∏£‡∏î‡∏°‡∏∞‡∏Ç‡∏≤‡∏°‡∏Ñ‡∏π‡πà',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡πÑ‡∏£‡πà‡∏ô‡∏¥‡∏Ñ‡∏°‡∏û‡∏±‡∏í‡∏ô‡∏≤',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡πÑ‡∏£‡πà‡∏°‡∏≤‡∏ö‡∏¢‡∏≤‡∏á‡∏û‡∏£',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡πÑ‡∏£‡πà‡∏°‡∏≤‡∏ö‡∏Ç‡πà‡∏≤',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏Ñ‡∏ô‡∏û‡∏¥‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÅ‡∏û‡∏∞‡∏ï‡∏≥‡∏ö‡∏•‡∏û‡∏±‡∏á‡∏£‡∏≤‡∏î',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ú‡∏π‡πâ‡∏õ‡∏•‡∏π‡∏Å‡∏™‡∏±‡∏ö‡∏õ‡∏∞‡∏£‡∏î‡∏ï‡∏≥‡∏ö‡∏•‡∏´‡∏ô‡∏≠‡∏á‡πÑ‡∏£‡πà',
            '‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏ó‡∏≥‡∏™‡∏ß‡∏ô‡∏ï‡∏≥‡∏ö‡∏•‡∏ï‡∏≤‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå'
        ];

        // Initialize datalist on page load
        function initCoopNamesList() {
            const datalist = document.getElementById('coop-names-list');
            datalist.innerHTML = COOP_NAMES.map(name => `<option value="${name}">`).join('');
        }

        // ==================== UTILITY FUNCTIONS ====================

        /**
         * Calculate working days between two dates
         * Excludes weekends (Sat/Sun) and Thai public holidays
         */
        function calculateWorkingDays(startDate, endDate) {
            if (!startDate || !endDate) return null;

            const start = new Date(startDate);
            const end = new Date(endDate);

            if (start > end) return null;

            let workingDays = 0;
            const current = new Date(start);

            // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ (‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö)
            current.setDate(current.getDate() + 1);

            while (current <= end) {
                const dayOfWeek = current.getDay();
                const dateStr = current.toISOString().split('T')[0];

                // Skip weekends (0 = Sunday, 6 = Saturday) and public holidays
                if (dayOfWeek !== 0 && dayOfWeek !== 6 && !PUBLIC_HOLIDAYS.includes(dateStr)) {
                    workingDays++;
                }

                current.setDate(current.getDate() + 1);
            }

            return workingDays;
        }

        /**
         * Format date string to Thai format
         */
        function formatDate(dateStr) {
            if (!dateStr) return '-';
            const date = new Date(dateStr);
            return date.toLocaleDateString('th-TH', { day: '2-digit', month: '2-digit', year: 'numeric' });
        }

        /**
         * Show/hide loading overlay
         */
        function showLoading(show = true) {
            const overlay = document.getElementById('loading-overlay');
            if (show) {
                overlay.classList.remove('hidden');
            } else {
                overlay.classList.add('hidden');
            }
        }

        /**
         * Show toast notification
         */
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toast-message');
            const toastIcon = document.getElementById('toast-icon');

            toastMessage.textContent = message;

            if (type === 'error') {
                toastIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>';
                toast.querySelector('div').classList.remove('bg-gray-800');
                toast.querySelector('div').classList.add('bg-red-600');
            } else {
                toastIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>';
                toast.querySelector('div').classList.remove('bg-red-600');
                toast.querySelector('div').classList.add('bg-gray-800');
            }

            toast.classList.remove('translate-y-20', 'opacity-0');

            setTimeout(() => {
                toast.classList.add('translate-y-20', 'opacity-0');
            }, 3000);
        }

        // ==================== API FUNCTIONS ====================

        /**
         * Fetch all records from backend
         */
        async function fetchAllRecords() {
            try {
                showLoading(true);
                const response = await fetch(`${SCRIPT_URL}?action=getAll`, {
                    redirect: 'follow'
                });
                const result = await response.json();

                if (result.success) {
                    allRecords = result.data;
                    applyFiltersAndRender();
                    updateSummary();
                } else {
                    showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ' + result.error, 'error');
                }
            } catch (error) {
                console.error('Error fetching records:', error);
                showToast('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏î‡πâ', 'error');
                renderEmptyState();
            } finally {
                showLoading(false);
            }
        }

        /**
         * Create new record
         */
        async function createRecord(recordData) {
            const response = await fetch(SCRIPT_URL, {
                method: 'POST',
                redirect: 'follow',
                body: JSON.stringify({ action: 'create', record: recordData })
            });
            return await response.json();
        }

        /**
         * Create multiple records
         */
        async function createRecordBatch(records) {
            const response = await fetch(SCRIPT_URL, {
                method: 'POST',
                redirect: 'follow',
                body: JSON.stringify({ action: 'createBatch', records: records })
            });
            return await response.json();
        }

        /**
         * Update existing record
         */
        async function updateRecord(recordData) {
            const response = await fetch(SCRIPT_URL, {
                method: 'POST',
                redirect: 'follow',
                body: JSON.stringify({ action: 'update', record: recordData })
            });
            return await response.json();
        }

        /**
         * Delete record
         */
        async function deleteRecordApi(id) {
            const response = await fetch(SCRIPT_URL, {
                method: 'POST',
                redirect: 'follow',
                body: JSON.stringify({ action: 'delete', id: id })
            });
            return await response.json();
        }

        /**
         * Upload file
         */
        async function uploadFileApi(fileData, fileName, mimeType, cooperativeName) {
            const response = await fetch(SCRIPT_URL, {
                method: 'POST',
                redirect: 'follow',
                body: JSON.stringify({
                    action: 'uploadFile',
                    fileData,
                    fileName,
                    mimeType,
                    cooperativeName
                })
            });
            return await response.json();
        }

        /**
         * Delete file
         */
        async function deleteFileApi(fileId) {
            const response = await fetch(SCRIPT_URL, {
                method: 'POST',
                redirect: 'follow',
                body: JSON.stringify({ action: 'deleteFile', fileId })
            });
            return await response.json();
        }

        // ==================== UI FUNCTIONS ====================

        function createDocItemRow(type = '', topic = '') {
            const div = document.createElement('div');
            div.className = 'doc-item-row grid grid-cols-1 md:grid-cols-2 gap-4 p-3 bg-gray-50 rounded-lg border border-gray-200 relative';
            div.innerHTML = `
                <div>
                     <label class="block text-xs font-medium text-gray-500 mb-1">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</label>
                     <select class="doc-type w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</option>
                        <option value="‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö" ${type === '‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö' ? 'selected' : ''}>‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö</option>
                        <option value="‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö" ${type === '‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö' ? 'selected' : ''}>‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö</option>
                     </select>
                </div>
                <div>
                     <label class="block text-xs font-medium text-gray-500 mb-1">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠</label>
                     <input type="text" class="doc-topic w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠" value="${topic}" required>
                </div>
                <button type="button" class="btn-remove-doc-item absolute -top-2 -right-2 bg-red-100 text-red-500 rounded-full p-1 shadow-sm hover:bg-red-200 transition-colors">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            `;

            // Remove button event
            div.querySelector('.btn-remove-doc-item').addEventListener('click', () => {
                const container = document.getElementById('doc-items-container');
                if (container.children.length > 1) {
                    div.remove();
                } else {
                    showToast('‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£', 'error');
                }
            });

            return div;
        }

        function openNewRegistryModal(dateStr = null) {
            isEditing = false;
            document.getElementById('modal-title').textContent = '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà';
            document.getElementById('form-record').reset();
            document.getElementById('record-id').value = '';
            document.getElementById('coop-days-info').classList.add('hidden');
            document.getElementById('group-days-info').classList.add('hidden');

            // Reset file upload
            selectedFile = null;
            currentAttachment = null;
            resetFileUploadUI();
            document.getElementById('current-attachment').classList.add('hidden');

            // Pre-fill date if provided
            if (dateStr) {
                document.getElementById('input-receive-coop').value = dateStr;
            }

            showModal();

            // Initialize Doc Items for New Record
            const container = document.getElementById('doc-items-container');
            container.innerHTML = '';
            container.appendChild(createDocItemRow()); // Add one empty row
            document.getElementById('btn-add-doc-item').classList.remove('hidden');
        }

        function showModal() {
            document.getElementById('modal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function hideModal() {
            document.getElementById('modal').classList.add('hidden');
            document.body.style.overflow = '';
        }

        function showDeleteModal(record) {
            recordToDelete = record;
            document.getElementById('delete-modal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function hideDeleteModal() {
            recordToDelete = null;
            document.getElementById('delete-modal').classList.add('hidden');
            document.body.style.overflow = '';
        }

        function updateCoopDaysInfo() {
            const startDate = document.getElementById('input-receive-coop').value;
            const endDate = document.getElementById('input-send-coop').value;
            const infoDiv = document.getElementById('coop-days-info');

            if (startDate && endDate) {
                const days = calculateWorkingDays(startDate, endDate);
                if (days !== null) {
                    infoDiv.textContent = `üìÖ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£: ${days} ‡∏ß‡∏±‡∏ô (‡πÑ‡∏°‡πà‡∏ô‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡πÄ‡∏™‡∏≤‡∏£‡πå-‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå)`;
                    infoDiv.classList.remove('hidden');
                } else {
                    infoDiv.classList.add('hidden');
                }
            } else {
                infoDiv.classList.add('hidden');
            }
        }

        function updateGroupDaysInfo() {
            const startDate = document.getElementById('input-receive-admin').value;
            const endDate = document.getElementById('input-group-complete').value;
            const infoDiv = document.getElementById('group-days-info');

            if (startDate && endDate) {
                const days = calculateWorkingDays(startDate, endDate);
                if (days !== null) {
                    infoDiv.textContent = `üìÖ ‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£: ${days} ‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£`;
                    infoDiv.classList.remove('hidden');
                } else {
                    infoDiv.classList.add('hidden');
                }
            } else {
                infoDiv.classList.add('hidden');
            }
        }

        async function handleFormSubmit(e) {
            e.preventDefault();

            const saveBtn = document.getElementById('btn-save');
            const spinner = document.getElementById('save-spinner');
            saveBtn.disabled = true;
            spinner.classList.remove('hidden');

            const coopName = document.getElementById('input-coop-name').value.trim();

            try {
                // Initialize common record data
                const baseRecordData = {
                    cooperative_name: coopName,
                    receive_from_coop_date: document.getElementById('input-receive-coop').value || '',
                    send_back_to_coop_date: document.getElementById('input-send-coop').value || '',
                    receive_from_admin_date: document.getElementById('input-receive-admin').value || '',
                    group_complete_date: document.getElementById('input-group-complete').value || '',
                    status: document.getElementById('input-status').value,
                    notes: document.getElementById('input-notes').value.trim()
                };

                // Gather Document Items
                const docItems = document.querySelectorAll('.doc-item-row');
                const recordsToSave = [];

                docItems.forEach(row => {
                    recordsToSave.push({
                        ...baseRecordData,
                        document_type: row.querySelector('.doc-type').value,
                        document_topic: row.querySelector('.doc-topic').value.trim()
                    });
                });

                // Handle file upload if exists
                if (selectedFile) {
                    showLoading(true); // Ensure loading is shown

                    // Convert file to Base64
                    const fileReader = new FileReader();
                    const base64Promise = new Promise((resolve, reject) => {
                        fileReader.onload = () => resolve(fileReader.result.split(',')[1]);
                        fileReader.onerror = reject;
                        fileReader.readAsDataURL(selectedFile);
                    });

                    const base64Data = await base64Promise;

                    // Show progress UI (simulated)
                    document.getElementById('upload-progress').classList.remove('hidden');
                    document.getElementById('progress-bar').style.width = '100%';
                    document.getElementById('progress-text').textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î...';

                    // Upload to Drive
                    const uploadResult = await uploadFileApi(base64Data, selectedFile.name, selectedFile.type, coopName);

                    if (uploadResult.success) {
                        // Add attachment info to base record data
                        baseRecordData.attachment_file_id = uploadResult.data.fileId;
                        baseRecordData.attachment_file_name = uploadResult.data.fileName;
                        baseRecordData.attachment_file_url = uploadResult.data.fileUrl;

                        // If we had a previous file and we are editing, we might want to delete it?
                        // For now, let's just replace the reference.
                        // Future improvement: delete old file if replaced.
                    } else {
                        throw new Error('Upload failed: ' + uploadResult.error);
                    }
                } else if (currentAttachment) {
                    // Keep existing attachment info
                    recordData.attachment_file_id = currentAttachment.id;
                    recordData.attachment_file_name = currentAttachment.name;
                    recordData.attachment_file_url = currentAttachment.url;
                }

                const recordId = document.getElementById('record-id').value;
                let result;

                // Handle Attachment for ALL records
                // If creating multiple records, they all get the same attachment reference
                recordsToSave.forEach(record => {
                    if (selectedFile) {
                        record.attachment_file_id = baseRecordData.attachment_file_id;
                        record.attachment_file_name = baseRecordData.attachment_file_name;
                        record.attachment_file_url = baseRecordData.attachment_file_url;
                    } else if (currentAttachment) {
                        record.attachment_file_id = currentAttachment.id;
                        record.attachment_file_name = currentAttachment.name;
                        record.attachment_file_url = currentAttachment.url;
                    }
                });

                if (isEditing && recordId) {
                    // Edit Mode: Update single record (take the first item, as edit mode forces 1 item)
                    const recordData = recordsToSave[0];
                    recordData.id = recordId;
                    result = await updateRecord(recordData);
                } else {
                    // Create Mode: Batch or Single
                    if (recordsToSave.length > 1) {
                        result = await createRecordBatch(recordsToSave);
                    } else {
                        result = await createRecord(recordsToSave[0]);
                    }
                }

                if (result && result.success) {
                    showToast(isEditing ? '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à' : '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
                    hideModal();
                    await fetchAllRecords();
                } else {
                    showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + (result.error || '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà'), 'error');
                }
            } catch (err) {
                console.error('Error saving record:', err);
                showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + err.message, 'error');
            } finally {
                saveBtn.disabled = false;
                spinner.classList.add('hidden');
                document.getElementById('upload-progress').classList.add('hidden');
                showLoading(false);
            }
        }

        function editRecord(record) {
            isEditing = true;
            document.getElementById('modal-title').textContent = '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£';
            document.getElementById('record-id').value = record.id;
            document.getElementById('input-coop-name').value = record.cooperative_name || '';

            // Setup Doc Items for Edit
            const container = document.getElementById('doc-items-container');
            container.innerHTML = '';
            container.appendChild(createDocItemRow(record.document_type || '', record.document_topic || ''));

            // Hide Add/Remove buttons in Edit Mode
            document.getElementById('btn-add-doc-item').classList.add('hidden');
            container.querySelectorAll('.btn-remove-doc-item').forEach(btn => btn.classList.add('hidden'));

            document.getElementById('input-receive-coop').value = record.receive_from_coop_date || '';
            document.getElementById('input-send-coop').value = record.send_back_to_coop_date || '';
            document.getElementById('input-receive-admin').value = record.receive_from_admin_date || '';
            document.getElementById('input-group-complete').value = record.group_complete_date || '';
            document.getElementById('input-status').value = record.status || '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£';
            updateCoopDaysInfo();
            updateGroupDaysInfo();

            // Handle Attachment
            selectedFile = null;
            resetFileUploadUI();

            if (record.attachment_file_id) {
                currentAttachment = {
                    id: record.attachment_file_id,
                    name: record.attachment_file_name,
                    url: record.attachment_file_url
                };
                showCurrentAttachment(currentAttachment);
            } else {
                currentAttachment = null;
                document.getElementById('current-attachment').classList.add('hidden');
            }

            showModal();
        }

        async function confirmDelete() {
            if (!recordToDelete) return;

            const deleteBtn = document.getElementById('btn-confirm-delete');
            const spinner = document.getElementById('delete-spinner');
            deleteBtn.disabled = true;
            spinner.classList.remove('hidden');

            try {
                const result = await deleteRecordApi(recordToDelete.id);
                if (result && result.success) {
                    showToast('‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
                    hideDeleteModal();
                    await fetchAllRecords();
                } else {
                    showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö: ' + (result.error || ''), 'error');
                }
            } catch (err) {
                console.error('Error deleting record:', err);
                showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö', 'error');
            }

            deleteBtn.disabled = false;
            spinner.classList.add('hidden');
        }

        function applyFiltersAndRender() {
            const searchTerm = document.getElementById('filter-search').value.toLowerCase();
            const typeFilter = document.getElementById('filter-type').value;
            const statusFilter = document.getElementById('filter-status').value;

            filteredRecords = allRecords.filter(record => {
                const matchSearch = !searchTerm ||
                    (record.cooperative_name || '').toLowerCase().includes(searchTerm) ||
                    (record.document_topic || '').toLowerCase().includes(searchTerm);
                const matchType = !typeFilter || record.document_type === typeFilter;
                const matchStatus = !statusFilter || record.status === statusFilter;
                return matchSearch && matchType && matchStatus;
            });

            // Sort by created_at descending
            filteredRecords.sort((a, b) => new Date(b.created_at || 0) - new Date(a.created_at || 0));

            // Reset to first page when filters change
            currentPage = 1;

            renderTableWithPagination();
        }

        // ==================== PAGINATION FUNCTIONS ====================

        function renderTableWithPagination() {
            const totalRecords = filteredRecords.length;
            const totalPages = Math.ceil(totalRecords / pageSize);

            // Ensure currentPage is within bounds
            if (currentPage > totalPages) currentPage = totalPages || 1;
            if (currentPage < 1) currentPage = 1;

            // Calculate start and end indices
            const startIndex = (currentPage - 1) * pageSize;
            const endIndex = Math.min(startIndex + pageSize, totalRecords);

            // Get records for current page
            const pageRecords = filteredRecords.slice(startIndex, endIndex);

            // Render table with page records (pass startIndex for correct numbering)
            renderTable(pageRecords, startIndex);

            // Update pagination UI
            updatePaginationUI(totalRecords, totalPages, startIndex, endIndex);
        }

        function updatePaginationUI(totalRecords, totalPages, startIndex, endIndex) {
            const paginationContainer = document.getElementById('pagination-container');

            if (totalRecords === 0) {
                paginationContainer.classList.add('hidden');
                return;
            }

            paginationContainer.classList.remove('hidden');

            // Update info text
            document.getElementById('pagination-info').textContent =
                `‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ ${startIndex + 1}-${endIndex} ‡∏à‡∏≤‡∏Å ${totalRecords}`;

            // Update page numbers
            document.getElementById('current-page').textContent = currentPage;
            document.getElementById('total-pages').textContent = totalPages;

            // Update button states
            const btnFirst = document.getElementById('btn-first-page');
            const btnPrev = document.getElementById('btn-prev-page');
            const btnNext = document.getElementById('btn-next-page');
            const btnLast = document.getElementById('btn-last-page');

            btnFirst.disabled = currentPage === 1;
            btnPrev.disabled = currentPage === 1;
            btnNext.disabled = currentPage === totalPages;
            btnLast.disabled = currentPage === totalPages;
        }

        function goToPage(page) {
            const totalPages = Math.ceil(filteredRecords.length / pageSize);
            if (page < 1 || page > totalPages) return;
            currentPage = page;
            renderTableWithPagination();
        }

        function changePageSize(newSize) {
            pageSize = parseInt(newSize);
            currentPage = 1; // Reset to first page
            renderTableWithPagination();
        }

        function clearFilters() {
            document.getElementById('filter-search').value = '';
            document.getElementById('filter-type').value = '';
            document.getElementById('filter-status').value = '';
            applyFiltersAndRender();
        }

        function renderEmptyState() {
            const tbody = document.getElementById('table-body');
            tbody.innerHTML = `
        <tr>
          <td colspan="12" class="px-4 py-12 text-center text-gray-500">
            <svg class="w-12 h-12 mx-auto mb-3 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
            </svg>
            <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</p>
          </td>
        </tr>
      `;
        }

        function renderTable(records, startIndex = 0) {
            const tbody = document.getElementById('table-body');

            if (records.length === 0) {
                tbody.innerHTML = `
          <tr>
            <td colspan="12" class="px-4 py-12 text-center text-gray-500">
              <svg class="w-12 h-12 mx-auto mb-3 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
              </svg>
              <p>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç</p>
            </td>
          </tr>
        `;
                return;
            }

            tbody.innerHTML = records.map((record, index) => {
                const coopDays = calculateWorkingDays(record.receive_from_coop_date, record.send_back_to_coop_date);
                const groupDays = calculateWorkingDays(record.receive_from_admin_date, record.group_complete_date);

                let statusClass = 'status-pending';
                if (record.status === '‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß') statusClass = 'status-complete';
                else if (record.status === '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£') statusClass = 'status-processing';

                let rowClass = '';
                if (record.status === '‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß') rowClass = 'row-complete';
                else if (record.status === '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£') rowClass = 'row-processing';
                else rowClass = 'row-pending';

                return `
          <tr class="table-row ${rowClass} transition-colors" data-id="${record.id}">
            <td class="px-4 py-3 text-sm text-gray-600">${startIndex + index + 1}</td>
            <td class="px-4 py-3 text-sm font-medium text-gray-800">${record.cooperative_name || '-'}</td>
            <td class="px-4 py-3 text-sm">
              <span class="px-2 py-1 rounded whitespace-nowrap ${record.document_type === '‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö' ? 'bg-white text-blue-700 border border-blue-200' : 'bg-white text-purple-700 border border-purple-200'}">
                ${record.document_type || '-'}
              </span>
            </td>
            <td class="px-4 py-3 text-sm text-gray-600">${record.document_topic || '-'}</td>
            <td class="px-4 py-3 text-sm text-gray-600">${formatDate(record.receive_from_coop_date)}</td>
            <td class="px-4 py-3 text-sm text-gray-600">${formatDate(record.send_back_to_coop_date)}</td>
            <td class="px-4 py-3 text-sm text-center font-semibold ${coopDays !== null ? 'text-blue-600' : 'text-gray-400'}">${coopDays !== null ? coopDays + ' ‡∏ß‡∏±‡∏ô' : '-'}</td>
            <td class="px-4 py-3 text-sm text-gray-600">${formatDate(record.receive_from_admin_date)}</td>
            <td class="px-4 py-3 text-sm text-gray-600">${formatDate(record.group_complete_date)}</td>
            <td class="px-4 py-3 text-sm text-center font-semibold ${groupDays !== null ? 'text-green-600' : 'text-gray-400'}">${groupDays !== null ? groupDays + ' ‡∏ß‡∏±‡∏ô' : '-'}</td>
            <td class="px-4 py-3 text-sm">
              <span class="px-2 py-1 rounded text-xs font-medium whitespace-nowrap ${statusClass} shadow-sm border border-opacity-20 border-gray-400">${record.status || '-'}</span>
            </td>
            <td class="px-4 py-3 text-sm">
                ${record.attachment_file_url ?
                        `<a href="${record.attachment_file_url}" target="_blank" class="text-blue-600 hover:text-blue-800 flex items-center gap-1 group">
                        <svg class="w-4 h-4 group-hover:scale-110 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"></path></svg>
                        ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå
                    </a>` :
                        '<span class="text-gray-400">-</span>'
                    }
            </td>
            <td class="px-4 py-3 text-sm">
              <div class="flex gap-1">
                <button onclick="editRecord(allRecords.find(r => r.id === '${record.id}'))" class="p-1.5 text-blue-600 hover:bg-blue-200 rounded transition-colors bg-white/50" title="‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                  </svg>
                </button>
                <button onclick="showDeleteModal(allRecords.find(r => r.id === '${record.id}'))" class="p-1.5 text-red-600 hover:bg-red-200 rounded transition-colors bg-white/50" title="‡∏•‡∏ö">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                  </svg>
                </button>
              </div>
            </td>
          </tr>
                    `;
            }).join('');
        }



        function updateSummary() {
            const summarySection = document.getElementById('summary-section');
            const summaryContent = document.getElementById('summary-content');

            if (allRecords.length === 0) {
                summarySection.classList.add('hidden');
                return;
            }

            summarySection.classList.remove('hidden');

            // Group by cooperative
            const groupedByCooperative = {};
            allRecords.forEach(record => {
                const coopName = (record.cooperative_name || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠').replace(/\s+/g, ' ').trim();
                if (!groupedByCooperative[coopName]) {
                    groupedByCooperative[coopName] = {
                        ‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö: [],
                        ‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö: []
                    };
                }
                if (record.document_type === '‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö' || record.document_type === '‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö') {
                    groupedByCooperative[coopName][record.document_type].push(record);
                }
            });

            let html = '';
            Object.keys(groupedByCooperative).sort().forEach(coopName => {
                const docs = groupedByCooperative[coopName];
                const totalDocs = docs['‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö'].length + docs['‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö'].length;

                html += `
          <div class="border border-gray-200 rounded-lg p-4">
            <h4 class="font-semibold text-gray-800 mb-3 flex items-center gap-2">
              <span class="w-8 h-8 bg-blue-100 text-blue-700 rounded-full flex items-center justify-center text-sm font-bold">${totalDocs}</span>
              ${coopName}
            </h4>
            <div class="grid grid-cols-1 gap-4">
        `;

                if (docs['‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö'].length > 0) {
                    html += `
            <div class="bg-blue-50 rounded-lg p-3">
              <h5 class="font-medium text-blue-800 mb-2">üìã ‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö (${docs['‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö'].length})</h5>
              <ul class="space-y-1 text-sm text-blue-700 break-words">
                ${docs['‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö'].map(d => {
                        let color = 'text-yellow-600';
                        if (d.status === '‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß') color = 'text-green-600';
                        else if (d.status === '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£') color = 'text-blue-600';
                        return `<li class="${color}">‚Ä¢ ${d.document_topic || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠'}</li>`;
                    }).join('')}
              </ul>
            </div>
          `;
                }

                if (docs['‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö'].length > 0) {
                    html += `
            <div class="bg-purple-50 rounded-lg p-3">
              <h5 class="font-medium text-purple-800 mb-2">üìú ‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö (${docs['‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö'].length})</h5>
              <ul class="space-y-1 text-sm text-purple-700 break-words">
                ${docs['‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö'].map(d => {
                        let color = 'text-yellow-600';
                        if (d.status === '‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß') color = 'text-green-600';
                        else if (d.status === '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£') color = 'text-blue-600';
                        return `<li class="${color}">‚Ä¢ ${d.document_topic || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠'}</li>`;
                    }).join('')}
              </ul>
            </div>
          `;
                }

                html += `
            </div>
          </div >
        `;
            });

            summaryContent.innerHTML = html;
        }

        // ==================== EVENT LISTENERS ====================

        function setupEventListeners() {
            // Add new button
            document.getElementById('btn-add-new').addEventListener('click', () => openNewRegistryModal());

            // Add Doc Item Button
            document.getElementById('btn-add-doc-item').addEventListener('click', () => {
                const container = document.getElementById('doc-items-container');
                container.appendChild(createDocItemRow());
            });

            // Modal close buttons
            document.getElementById('btn-close-modal').addEventListener('click', hideModal);
            document.getElementById('btn-cancel').addEventListener('click', hideModal);
            document.getElementById('modal-backdrop').addEventListener('click', hideModal);

            // Form submit
            document.getElementById('form-record').addEventListener('submit', handleFormSubmit);
            document.getElementById('form-daily-op').addEventListener('submit', handleDailyOpSubmit); // NEW

            // Date change listeners for auto-calculation and synchronization
            document.getElementById('input-receive-coop').addEventListener('change', updateCoopDaysInfo);

            document.getElementById('input-send-coop').addEventListener('change', function () {
                updateCoopDaysInfo();
                // Sync to Group Completed Date
                document.getElementById('input-group-complete').value = this.value;
                updateGroupDaysInfo();
            });

            document.getElementById('input-receive-admin').addEventListener('change', updateGroupDaysInfo);

            document.getElementById('input-group-complete').addEventListener('change', function () {
                updateGroupDaysInfo();
                // Sync to Returned to Cooperative Date
                document.getElementById('input-send-coop').value = this.value;
                updateCoopDaysInfo();
            });

            // Filters
            document.getElementById('filter-search').addEventListener('input', applyFiltersAndRender);
            document.getElementById('filter-type').addEventListener('change', applyFiltersAndRender);
            document.getElementById('filter-status').addEventListener('change', applyFiltersAndRender);
            document.getElementById('btn-clear-filter').addEventListener('click', clearFilters);

            // Daily Ops Filters
            document.getElementById('daily-filter-date').addEventListener('change', renderDailyOpsTable);

            // Pagination
            document.getElementById('page-size').addEventListener('change', (e) => changePageSize(e.target.value));
            document.getElementById('btn-first-page').addEventListener('click', () => goToPage(1));
            document.getElementById('btn-prev-page').addEventListener('click', () => goToPage(currentPage - 1));
            document.getElementById('btn-next-page').addEventListener('click', () => goToPage(currentPage + 1));
            document.getElementById('btn-last-page').addEventListener('click', () => {
                const totalPages = Math.ceil(filteredRecords.length / pageSize);
                goToPage(totalPages);
            });

            // Delete modal
            document.getElementById('btn-cancel-delete').addEventListener('click', hideDeleteModal);
            document.getElementById('btn-confirm-delete').addEventListener('click', confirmDelete);

            // File Upload Listeners
            setupFileUploadListeners();
        }

        function setupFileUploadListeners() {
            const dropZone = document.getElementById('file-drop-zone');
            const fileInput = document.getElementById('file-input');
            const btnCancelUpload = document.getElementById('btn-cancel-upload');
            const btnRemoveAttachment = document.getElementById('btn-remove-attachment');

            // Handling drag and drop events
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, preventDefaults, false);
            });

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            dropZone.addEventListener('dragenter', () => dropZone.classList.add('border-blue-500', 'bg-blue-50'));
            dropZone.addEventListener('dragover', () => dropZone.classList.add('border-blue-500', 'bg-blue-50'));
            dropZone.addEventListener('dragleave', () => dropZone.classList.remove('border-blue-500', 'bg-blue-50'));
            dropZone.addEventListener('drop', (e) => {
                dropZone.classList.remove('border-blue-500', 'bg-blue-50');
                const dt = e.dataTransfer;
                const files = dt.files;
                handleFiles(files);
            });

            // Click to select
            dropZone.addEventListener('click', (e) => {
                if (e.target !== btnCancelUpload) fileInput.click();
            });

            fileInput.addEventListener('change', function () {
                handleFiles(this.files);
            });

            btnCancelUpload.addEventListener('click', (e) => {
                e.stopPropagation();
                selectedFile = null;
                fileInput.value = '';
                resetFileUploadUI();
            });

            btnRemoveAttachment.addEventListener('click', async () => {
                if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                    if (currentAttachment && currentAttachment.id) {
                        // Optional: Call API to delete file from Drive immediately
                        // For now we just remove reference
                    }
                    currentAttachment = null;
                    document.getElementById('current-attachment').classList.add('hidden');
                    document.getElementById('file-drop-zone').classList.remove('hidden');
                }
            });
        }

        function handleFiles(files) {
            if (files.length > 0) {
                const file = files[0];
                // Validate file size (10MB)
                if (file.size > 10 * 1024 * 1024) {
                    showToast('‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 10MB', 'error');
                    return;
                }

                selectedFile = file;
                displaySelectedFile(file);
            }
        }

        function displaySelectedFile(file) {
            const dropZoneContent = document.getElementById('drop-zone-content');
            const fileDisplay = document.getElementById('selected-file-display');
            const fileName = document.getElementById('selected-file-name');
            const fileSize = document.getElementById('selected-file-size');

            dropZoneContent.classList.add('hidden');
            fileDisplay.classList.remove('hidden');

            fileName.textContent = file.name;
            fileSize.textContent = (file.size / 1024 / 1024).toFixed(2) + ' MB';
        }

        function resetFileUploadUI() {
            const dropZoneContent = document.getElementById('drop-zone-content');
            const fileDisplay = document.getElementById('selected-file-display');
            const fileInput = document.getElementById('file-input');

            dropZoneContent.classList.remove('hidden');
            fileDisplay.classList.add('hidden');
            fileInput.value = '';

            // If we have an existing attachment, hide dropzone
            if (currentAttachment) {
                document.getElementById('file-drop-zone').classList.add('hidden');
            } else {
                document.getElementById('file-drop-zone').classList.remove('hidden');
            }
        }

        function showCurrentAttachment(attachment) {
            const container = document.getElementById('current-attachment');
            const link = document.getElementById('attachment-link');

            link.textContent = attachment.name;
            link.href = attachment.url;
            container.classList.remove('hidden');
            document.getElementById('file-drop-zone').classList.add('hidden');
        }

        // ==================== INITIALIZE APP ====================

        async function initApp() {
            setupEventListeners();

            // Initialize cooperative names datalist
            initCoopNamesList();

            // Load initial data
            await Promise.all([
                fetchAllRecords(),
                fetchDailyOps()
            ]);

            // Set default view to Dashboard
            switchView('dashboard');
        }

        // Start the app
        initApp();
    </script>
</body>

</html>